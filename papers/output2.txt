ArtefactDetectionandRemovalAlgorithms
forEEGDiagnosticSystems
SimonO'Regan
November17,2013
AThesisSubmittedtothe
NationalUniversityofIreland
inFullmentoftheRequirementsfor
theDegreeofPh.D.
Supervisors:Dr.WilliamMarnane
Dr.GordonLightbody

Dr.GeraldineBoylan
HeadofDepartment:Dr.NabeelRiza
DepartmentofElectricalandElectronicEngineering,
NationalUniversityofIreland,Cork.
Abstract

Theelectroencephalogram(EEG)isamedicaltechnologytha
tisusedinthemonitoring
ofthebrainandinthediagnosisofmanyneurologicalillnes
ses.Althoughcoarseinits
precision,theEEGisanon-invasivetoolthatrequiresmini
malset-uptimes,andissuitably
unobtrusiveandmobiletoallowcontinuousmonitoringofth
epatient,eitherinclinicalor
domesticenvironments.Consequently,theEEGisthecurren
ttool-of-choicewithwhich
tocontinuouslymonitorthebrainwheretemporalresolutio
n,ease-of-useandmobilityare
important.

Traditionally,EEGdataareexaminedbyatrainedclinician
whoidentiesneurological
eventsofinterest.However,recentadvancesinsignalproc
essingandmachinelearning
techniqueshaveallowedtheautomateddetectionofneurolo
gicaleventsformanymedical
applications.Indoingso,theburdenofworkontheclinicia
nhasbeensignicantlyre-
duced,improvingtheresponsetimetoillness,andallowing
therelevantmedicaltreatment
tobeadministeredwithinminutesratherthanhours.

However,astypicalEEGsignalsareoftheorderofmicrovolt
s(
V
),contaminationby
signalsarisingfromsourcesotherthanthebrainisfrequen
t.Theseextra-cerebralsources,
knownasartefacts,cansignicantlydistorttheEEGsignal
,makingitsinterpretationdi-
cult,andcandramaticallydisimproveautomaticneurologi
caleventdetectionclassication
performance.

Thisthesistherefore,contributestothefurtherimprovem
entofautomatedneurological
eventdetectionsystems,byidentifyingsomeofthemajorob
staclesindeployingthese
EEGsystemsinambulatoryandclinicalenvironmentssothat
theEEGtechnologiescan
emergefromthelaboratorytowardsreal-worldsettings,wh
eretheycanhaveareal-impact
onthelivesofpatients.Inthiscontext,thethesistackles
threemajorproblemsinEEG
monitoring,namely:(i)theproblemofhead-movementartef
actsinambulatoryEEG,(ii)
thehighnumbersoffalsedetectionsinstate-of-the-art,a
utomated,epileptiformactivity
detectionsystemsand(iii)falsedetectionsinstate-of-t
he-art,automatedneonatalseizure
detectionsystems.Toaccomplishthis,thethesisemploysa
widerangeofstatistical,
signalprocessingandmachinelearningtechniquesdrawnfr
ommathematics,engineering
andcomputerscience.

Therstbodyofworkoutlinedinthisthesisproposesasyste
mtoautomaticallydetect
head-movementartefactsinambulatoryEEGandutilisessup
ervisedmachinelearning
i
classierstodoso.Theresultinghead-movementartefactd
etectionsystemistherst
ofitskindandoersaccuratedetectionofhead-movementar
tefactsinambulatoryEEG.
Subsequently,additionalphysiologicalsignals,inthefo
rmofgyroscopes,areusedtodetect
head-movementsandindoingso,bringadditionalinformati
ontothehead-movement
artefactdetectiontask.AframeworkforcombiningEEGandg
yroscopesignalsisthen
developed,oeringimprovedhead-movementartefactdetec
tion.
TheartefactdetectionmethodsdevelopedforambulatoryEE
Garesubsequentlyadapted
foruseinanautomatedepileptiformactivitydetectionsys
tem.Informationfromsupport
vectormachinesclassiersusedtodetectepileptiformact
ivityisfusedwithinformation
fromartefact-specicdetectionclassiersinordertosig
nicantlyreducethenumberof
falsedetectionsintheepileptiformactivitydetectionsy
stem.Bythismeans,epilepti-
formactivitydetectionwhichcomparesfavourablywithoth
erstate-of-the-artsystemsis
achieved.

Finally,theproblemoffalsedetectionsinautomatedneona
talseizuredetectionisap-
proachedinanalternativemanner;blindsourceseparation
techniques,complimentedwith
informationfromadditionalphysiologicalsignalsareuse
dtoremoverespirationartefact
fromtheEEG.Inutilisingthesemethods,someencouraginga
dvanceshavebeenmadein
detectingandremovingrespirationartefactsfromtheneon
atalEEG,andindoingso,the
performanceoftheunderlyingdiagnostictechnologyisimp
roved,bringingitsdeployment
inthereal-world,clinicaldomainonestepcloser.
ii
Contents

1Introduction
11.1Introduction....................................
1
1.2Aimandscopeofthisthesis.........................
..2
1.3Outlineofthesis.................................
3
1.4Publicationsarisingfromthesis...................
......5
2EEGArtefacts
72.1Introduction....................................
7
2.2Theelectroencephalogram.........................
...7
2.3WhatareEEGartefacts?............................
8
2.3.1Physiologicalartefacts........................
..10
2.3.2Non-physiologicalartefacts....................
...17
2.4Artefactavoidanceandminimisation................
......19
2.5Biomedicalsignalprocessingandmachinelearning....
..........20
2.5.1Machinelearning.............................20

2.5.2Blindsourceseparation.........................
22
2.6Manualandsemi-automaticartefactremoval..........
.......25
iii
2.7AutomatedEEGartefactdetectionandremoval:Areview.
.........27
2.7.1Artefactdetection............................2
7
2.7.2Artefactremoval.............................28
2.8EEGartefactsinautomatedEEGdiagnosticsystems.....
........33
2.8.1Epileptiformactivityandepilepticseizuredetecti
on.........34
2.8.2EEGartefactsinepileptiformactivitydetectionsys
tems.......37
2.8.3Neonatalseizuredetection......................
..39
2.8.4EEGartefactsinneonatalseizuredetection........
......41
2.9Datasetsandmetrics..............................
.42
2.9.1Head-movementartefactsinadultEEG..............
..43
2.9.2OcularandmovementartefactsinepileptiformEEG...
......46
2.9.3NeonatalEEG..............................47

2.9.4Performanceassessment.........................
48
2.10Summary.....................................52
3Detectingartefactsarisingfromhead-movements54
3.1Introduction....................................
54
3.2Theproblemofhead-movementartefactsinambulatoryEE
G........55
3.2.1Generalisedhead-movementartefactdetection:isit
possible?....55
3.2.2AmbulatoryREACTsystem......................56

3.2.3Artefactdetectionusingsupervisedmachinelearnin
g.........58
3.3EEGfeatures...................................59
3.3.1Timedomainfeatures..........................60
iv
3.3.2Frequencydomainfeatures.......................
70
3.3.3Entropy-basedfeatures.........................
.73
3.4Featurereductionandlineardiscriminantclassicati
on............75
3.4.1Featurereductionusingmutualinformationevaluati
onfunction...76
3.4.2MIEFresults...............................78

3.4.3Lineardiscriminantclassication...............
.....79
3.4.4LDCperformance............................82
3.5Supportvectormachines...........................
..83
3.5.1SVMtheoreticalbackground......................
84
3.5.2SVMmodelselection...........................87

3.5.3SVMperformance............................87
3.6Summary.....................................88
4Detectinghead-movementartefactswithgyroscopes90
4.1Introduction....................................
90
4.2Gyroscopes....................................90

4.3Gyroscopefeatures...............................
.96
4.4Featurereductionandlineardiscriminantclassicati
on............103
4.4.1Mutualinformationevaluationfunction...........
.....104
4.4.2Lineardiscriminantclassication...............
.....105
4.5Supportvectormachines...........................
..106
4.5.1GyroscopeSVM.............................108

4.5.2ComparisonofEEGandgyroscopeSVMperformance.....
...109
v
4.6Summary.....................................111
5MultimodaldetectionofEEGhead-movementartefacts112
5.1Introduction....................................
112
5.2Multimodalfusion................................
113
5.3Featurefusion...................................
114
5.3.1Featurefusionperformance......................
.115
5.4Scorefusion....................................1
15
5.4.1Mean/Sumrule..............................116

5.4.2Productrule...............................117

5.4.3Maximumrule..............................117

5.4.4Minimumrule..............................118

5.4.5Scorefusionperformance........................
118
5.5Decisionfusion..................................
119
5.5.1LogicalANDmethod..........................121

5.5.2LogicalORmethod...........................121

5.5.3Decisionfusionperformance.....................
..122
5.6Comparisonoffusionmethods:earlyintegrationvs.lat
eintegration....123
5.7Summary.....................................125
6Robustepileptiformactivitydetection
1266.1Introduction....................................
126
6.2Automatedepilepsydetection......................
....127
vi
6.3Ocularandmovementartefacts......................
...127
6.4ReducingfalsepositiveswithoutremovingvaluableEEG
information....131
6.5Epileptiformdetectionclassier..................
.......133
6.5.1Detectionsystem.............................13
3
6.5.2Preprocessing...............................13
4
6.5.3EEGfeaturegeneration.........................1
34
6.5.4Classiers.................................137

6.5.5Thresholdchoice.............................14
0
6.5.6Metrics..................................140
6.6Classierfusionarchitectures....................
......141
6.6.1Scorefusion................................142

6.6.2Decisionfusion..............................14
3
6.7Comparisonoffusionmethods.......................
..145
6.7.1Epoch-basedmetrics...........................1
45
6.7.2Event-basedmetrics...........................1
46
6.8Summary.....................................148
7Artefactremovalforautomatedneonatalseizuredetection149
7.1Introduction....................................
149
7.2Neonatalseizuredetection........................
....150
7.2.1Neonatalseizure.............................15
0
7.2.2Automatedneonatalseizuredetection.............
....150
7.3Respiratoryartefactandfalsedetections...........
.........151
vii
7.4Automatedartefactremoval........................
...153
7.5Data........................................156

7.6DeVosmethod:correlatingSOBIwithrespiratorytrace.
..........157
7.6.1Secondorderblindidentication.................
...157
7.6.2Removingrespiratoryartefactcomponents.........
......159
7.6.3Algorithmperformance.........................1
61
7.7Respiratoryartefactremovalwithoutarespiratorytra
ce...........163
7.7.1Electrocardiogram-derivedrespirationsignal....
..........164
7.7.2RespiratoryartefactremovalwiththeEDRsignal....
......166
7.7.3Artefactsonadditionalphysiologicalsignals.....
.........169
7.8Summary.....................................171
8Conclusionsandfuturework
1748.1Conclusions....................................1
74
8.2Futureresearchdirections........................
....177
8.2.1EEGhead-movementartefactdetection.............
...178
8.2.2Multimodalhead-movementartefactdetection......
......178
8.2.3Artefactprocessinginautomatedepileptiformactiv
itydetectionsys-
tems....................................179
8.2.4Respiratoryartefactremovalinautomatedneonatals
eizuredetec-
tionsystems................................181
8.3Finalremarks...................................1
81
Acknowledgements
183viii
Statementoforiginality
185ListofTables
186ListofFigures
187References
197ix
Acronyms

ANSeRAlgorithmforNeonatalSeizureRecognition

ARAutoregressive

BCIBrainComputerInterface

BSSBlindSourceSeparation

CCACanonicalCorrelationAnalysis

CTRConventionalTrialRejection

CUHCorkUniversityHospital

CUMHCorkUniversityMaternityHospital

DCDirectCurrent

DFTDiscreteFourierTransform

DSPDigitalSignalProcessor

ECGElectrocardiogram

EDRElectrocardiogram-derivedRespiration

EEDSPEcientEmbeddedDigitalSignalProcessing

EEGElectroencephalogram

EMGElectromyogram

EOGElectrooculogram

EPEvokedPotential

ERPEvent-relatedPotential

FDFalseDetection

FDRFalseDetectionRate

FD/hFalseDetectionsperhour

FFTFastFourierTransform

FIRFiniteImpulseResponse

FNFalseNegative

FPFalsePositive
x
FTFourierTransform

GDRGoodDetectionRate

HIEHypoxicIschemicEncephalopathy

ICIndependentComponent

ICAIndependentComponentAnalysis

ICUIntensiveCareUnit

IMAInfusionMotorArtefact

IWBWIntensityWeightedMeanBandwidth

IWMFIntensityWeightedMeanFrequency

LDLinearDiscriminant

LDCLinearDiscriminantClassier

LOO-CVLeaveOneOutCrossValidation

MAMovingAverage

MIMutualInformation

MIEFMutualInformationEvaluationFunction

NICUNeonatalIntensiveCareUnit

PCAPrincipalComponentAnalysis

PDFProbabilityDensityFunction

PSDPowerSpectralDensity

REACTReal-timeEEGAnalysisforEventDetection

RBFRadialBasisFunction

RMSRootMeanSquared

RSARespiratorySinusArrhythmia

ROCReceiverOperatingCharacteristic

SOBISecondOrderBlindIdentication

SVDSingularValueDecomposition

SVMSupportVectorMachine

TNTrueNegative

TPTruePositive

UCCUniversityCollegeCork

UCLHUniversityCollegeLondonHospitals
xi
Chapter1

Introduction

1.1Introduction

Electroencephalography(EEG)isamedicaltechnologythat
isusedinthemonitoringof
thebrainanddiagnosisofmanyneurologicalillnesses.Bym
easuringvoltageonorjust
belowthescalp,EEGisthetechnologyofchoiceinepilepsya
ndneonatalseizuredetection
aswellasinotherdiagnosticssuchassleepanalysis.Simil
arly,inevoked/event-related
potentialstheEEGisusedtoevaluatebrainfunction,often
inpatientswithcognitive
diseases(SaneiandChambers,2007).Inaddition,manybrai
n-computerinterface(BCI)
applicationsutilizeEEGasadirectcommunicationpathway
betweenthebrainandan
externaldevice,mostcommonlyforassisting,augmenting,
orrepairinghumancognitive
orsensory-motorfunctions(Dornhegeetal.,2007).

ToutilizetheEEGforanyoftheaforementionedapplication
srequiresinterpretationand
processingofvastquantitiesofinformation.Traditional
ly,EEGdataisexaminedbya
trainedclinicianwhoidentiesneurologicaleventsofint
erest.However,recentadvances
insignalprocessingandmachinelearningtechniqueshavea
llowedtheautomateddetec-
tionofneurologicaleventsformanymedicalapplications.
Byautomatingthedetection
ofneurologicallyrelevantevents,theburdenofworkonthe
cliniciancanbesignicantly
reduced,improvingtheresponsetimetotheillness,andall
owingsuitablemedicaltreat-
menttobeadministeredwithinminutesratherthanhours(Th
omas,2011).Inthecaseof
BCI,automatedneurologicaleventdetectionhasmadepossi
blethisemergingengineering
eld,withnewtechnologiesandapplicationsbeingcreated
onanongoingbasis(Wolpaw
1
andWolpaw,2012).

However,astypicalEEGsignalsareoftheorderofmicrovolt
s(
V
),contaminationby
non-cerebralsignalsisfrequent.Theseartefactscansign
icantlydistorttheEEGsignal,
makingitsinterpretationdicult,andcandramaticallydi
simproveautomaticneurologi-
caleventdetectionclassicationperformance.Inparticu
lar,contaminationofEEGsignals
byartefactsarisingfromheadmovementshavebeenaserious
obstacleinthedeployment
ofautomaticneurologicaleventdetectionsystemsinambul
atoryEEG,i.e.environments
wherethepatientoruserhasunrestrictedmovement.Simila
rly,analysisofepileptic
andneonatalseizuredetectionsystemsdevelopedbytheBio
medicalSignalProcessing
GroupatUniversityCollegeCork(UCC),haveidentiedmove
ment,ocularandrespira-
toryartefactsasproblematic,leadingtoalargenumberoff
alsedetections,andeectively
preventingtheseautomaticneurologicaleventdetections
ystemsfrombeingdeployedin
aclinicalsetting.Thisthesis,therefore,investigatesa
nddevelopsanumberofpromising
artefactdetectionandremovalalgorithmsforuseinthesea
utomaticneurologicalevent
detectionsystems.

1.2Aimandscopeofthisthesis

Asignicantportionoftheartefactdetectionandremovalt
echniquesoutlinedinthe
literatureaddressEEGrecordedinenvironmentswheretheu
serisinstructedtolimit
behavioursthatmaycauseartefacts.Alternatively,manyp
apersvalidatetheperformance
oftheirartefactprocessingalgorithmsonsimulatedorsel
ectivedatasets.Inorderto
eectivelyimplementareal-world,automatedneurologica
levent-detectionsystem,the
algorithmmustbecapableofdealingwiththeentirerangeof
EEGsignalsthatmayarise
innoisy,medicalenvironments.Thesesystemsmustprovide
methodsthatcomfortably
dealwiththewidespreadoccurrenceofEEGartefactsandber
obustintheclassication
oftheneurologicaleventforwhichitisdesigned.

Therearemanypaperspublishedoutliningmethodsoftreati
ngEEGartefacts(Barlow,
1984;Andereretal.,1999;vandeVeldeetal.,1999;Delorme
etal.,2001;Jamesand
Gibson,2003;Gasseretal.,2005;Shokeretal.,2005;Winkl
eretal.,2011).Anover-
whelmingmajorityofthesepapersfocuson\cleaning"theEE
Gforvisibleinspection,
oftenforoneparticularartefacttype.However,fewerpape
rsfocusonthoseartefacts
whicharemostproblematicforspeciceventdetectionappl
icationsinamedicalsetting.
2
Whilemanytechniquesareusefulforvisiblyremovingartef
actby\cleaning"theEEG,
comparativelyfewrecordhowtheseartefactsaecttheeven
tdetectionsystemsinques-
tion.Inmanycases,thisleadstoartefactremovaltechniqu
eswhichnegativelyimpacton
theperformanceoftheeventdetectionssystembymistakenl
yremovingvaluableneural
EEGinformation.

Thisthesisaimstoexploreanumberofmethodsofimprovingt
woautomaticneurological
eventdetectionsystemsunderdevelopmentattheBiomedica
lSignalProcessingGroup
atU.C.C.Therstoftheseisanepileptiformactivityandep
ilepticseizuredetection
systemforuseinanambulatorysetting.Thisresearchwasun
dertakenaspartofthe
developmentoftheREACT(
R
eal-time
E
EG
A
nalysisforEventDete
CT
ion)ambulatory
real-timeEEGsystemandisbasedondatafromroutineEEGrec
ordedatCorkUniversity
Hospital(CUH).Thesecondeventdetectionsysteminvestig
atedisanautomatedneonatal
seizuredetectionsystemforreal-timewardmonitoringofa
t-riskbabiesintheneonatal
intensivecarenit(NICU).Thisresearchwascarriedoutwit
htheNeonatalBrainResearch
GroupindevelopingtheANSeR(
A
lgorithmfor
N
eonatal
Se
izure
R
ecognition)system
andimplementedwithdatacollectedatNICUsatCorkUnivers
ityHospitalandUniversity
CollegeLondonHospitals(UCLH).

1.3Outlineofthesis

Thethesisisdividedintothefollowingchapters:

Chapter2
introducesthedierenttypesofEEGartefacts;theircause
s,characteristics
andmorphologies.Acomprehensiveliteraturereviewofexi
stingartefactdetectionand
removaltechniquesisthenpresented.Additionalliteratu
rereviewsofEEGdiagnostic
systemsintheformofautomatedepileptiformactivityande
pilepticseizuredetectionas
wellasautomatedneonatalseizuredetectionarealsoinclu
ded.Thischaptergoesonto
discussexistingmethodsofdealingwithartefactsinthese
automatedneurologicalevent
detectionsystems.Finally,thischapterintroducestheda
tasetsusedtodevelopartefact
detectionandremovaltechniquesinthethesis.

Chapter3
aimstocharacterisetheartefactsthatarisefromhead-mov
ementsinanam-
bulatoryenvironment.Anartefactdetectionsystemisthen
designedtodetectartefacts
arisingfromheadmovements.Arobustsystemisproducedwhe
rebyartefactsarisingfrom
head-movementsareaccuratelydetectedintheEEG.
3
Chapter4
investigatesthefeasibilityofusingadditionalphysical
signalstodetectEEG
artefactsarisingfromheadmovements.Gyroscopesignalsf
romtheEmotivEPOCheadset
areusedasameansofquantifyinghead-movement,andsubseq
uentlyutilisedtodetermine
whetherornotEEGartefactshavebeenproducedintheEEG.

Chapter5
exploresthewaysinwhichtheEEGandgyroscopesignalscanb
ecombined
inordertoimprovetheoverallperformanceofhead-movemen
tartefactdetection.A
comprehensivemultimodal,datafusionanalysisofthesesi
gnalsatthefeatureandclassier
levelsiscarriedout.

Chapter6
investigatesartefactdetectioninthecontextofanautoma
tedneurological
eventdetectionsystem.Automatedartefactdetectionisin
corporatedintoanautomated
epileptiformactivitydetectionsystembyperformingclas
sierfusionofepileptiformand
artefactdetectionclassiers.Indoingso,falsedetectio
nsofepileptiformeventsaresignif-
icantlyreduced,resultinginstate-of-the-artepileptif
ormactivitydetectionwhenall(or
almostall)epileptiformeventsmustbedetected.

Chapter7
explorestheissueofartefactremovalfromEEG.Manycurren
ttechnologies
advocatetheuseofartefactremovaltechniques,eitherbyd
etectingartefactandthen
rejectingthecontaminatedsectionsofEEGorbyusingsomef
ormofblindsourcesepa-
rationtechniquetodecomposetheEEGintoestimatedsource
signalsandremovethose
sourcesdeemedartefactual.Inordertoinvestigateartefa
ctremovalinthecontextofau-
tomatedneurologicaleventdetectionsystems,thischapte
rfocusesonrespiratoryartefact
inneonatalEEG.Intheneonatalseizuredetectionsystemde
signedbytheneonatalbrain
researchgroupatUCC,respiratoryartefactwasfoundtober
esponsibleforover50%of
falsepositivedetections.Workinthischapter,therefore
investigatestheremovalofrespi-
ratoryartefactwithblindsourceseparationalgorithmsai
dedbyadditionalphysiological
signals.

Chapter8
summarisesthemainndingsofthisthesis,andplacesthen
dingsinthe
contextofcurrentartefactdetectionandremovaltechniqu
es.Itgoesontooutlinethe
implicationsforEEGingeneralaswellasautomaticmedical
EEGdiagnosticsystemsin
particular.Thischapterthenoutlinesquestionsandissue
sresultingfromthisthesisand
somefutureresearchdirectionsarediscussed.
4
1.4Publicationsarisingfromthesis

Publications-Journals

O'ReganS.
,Faul,S.andMarnaneW.P.,
\AutomaticdetectionofEEGartefactsarisingfromheadmov
ements",
MedicalEngineer-
ing&Physics
,35(7),867-874,2013
O'ReganS.
andMarnaneW.P.,
\Multimodaldetectionofhead-movementartefactsinEEG",
JournalofNeuroscience
Methods
,218(1):110-120,2013
O'ReganS.
,KelleherD.,TemkoA.,McNamaraB.,CostelloD.,andMarnan
eW.P.
\Robustautomatedepileptiformactivitydetectioninthep
resenceofocularandmovement
artefacts",
InPreparation
O'ReganS.
,LightbodyG.,TemkoA.,MathiesonS.,BoylanG.andMarnane
W.P.,
\Respirationartefactremovalinautomatedneonatalseizu
redetectionusingblindsource
separationandanelectrocardiogramderivedrespiratorys
ignal",
InPreparation
KelleherD.,TemkoA.,
O'ReganS.
,NashD.,McNamaraB.,CostelloD.,andMarnane
W.P.

\Epileptiformactivitydetectionusingsupportvectormac
hines",
InPreparation
Publications-Peer-reviewedConferences

KelleherD.,TemkoA.,
O'ReganS.
,NashD.,McNamaraB.,CostelloD.,andMarnane
W.P.

\Parallelartefactrejectionforepileptiformactivityde
tectioninroutineEEG",
InPro-
ceedingsoftheIEEEEngineeringinMedicineandBiologyCon
ference(EMBC)
,2011,pp
7953:7956

O'ReganS.
,Faul,S.andMarnaneW.P.,
\AutomaticdetectionofEEGartefactsarisingfromheadmov
ements",
Proceedingsofthe
IEEEEngineeringinMedicineandBiologyConference(EMBC)
,2010,pp6353:6356
5
O'ReganS.
,Faul,S.andMarnaneW.P.,
\AutomaticdetectionofEEGartefactsarisingfromheadmov
ementsusinggyroscopes",
Proceedingsofthe3rdInternationalSymposiumonAppliedS
ciencesinBiomedicaland
CommunicationTechnologies(ISABEL)
,2010,pp1:5
6
Chapter2

EEGArtefacts

2.1Introduction

ThischapterintroducestheconceptofEEGartefactsandgiv
esanoverviewofthepub-
lishedliteraturethatoutlinestheirvariouscharacteris
ticsandmorphologies.Aliterature
reviewofthesignalprocessingandmachinelearningmethod
susedindetectingandremov-
ingEEGartefactsisthenpresented.Anoverviewofthepubli
shedliteratureinautomated
epilepsyandneonatalseizuredetectionsystemsissubsequ
entlyoutlinedwithparticular
emphasisontheroleplayedbyartefactprocessinginthesee
nvironments.Finally,ade-
tailedaccountofthedatausedinthisthesisispresented.

2.2Theelectroencephalogram

Theelectroencephalogram(EEG)canbebroadlydescribedas
therecordingofaveraged
electricalactivityatdierentpositionsonthehead.More
specically,EEGmeasures
ioniccurrentowsduringsynapticexcitationofthedendri
tesoflargegroupsofpyramidal
neuronsinthecerebralcortex(LopesdaSilva,1991).Insca
lpEEG,signalsaremeasured
betweenpairsofelectrodesplacedinasymmetricalarrayon
thescalp(Figure2.1).The
mostcommonstandardplacementguideforelectrodesisthe1
0-20system(Jasper,1958),
whereeachelectrodesiteisidentiedbyaletterandanumbe
r.Thelettersrefertothe
F
rontal,
C
entral,
P
arietal,
T
emporaland
O
ccipitallobesofthebrain.Thenumbersrefer
tothehemispherelocations;evennumbersrefertotheright
hemisphereandoddnumbers
7
Figure2.1:EEGelectrodesplacedaccordingtothe10-20sys
tem.
tothelefthemisphere.`Z'referstoanelectrodeplacedont
hemid-line.Thenumber
ofEEGelectrodescanvarywithusage,usuallyrangingfrom9
electrodesforneonatal
monitoringtoasmanyashundredsofelectrodesinepilepsy,
evokedpotentialandbrain
computerinterfaceapplications.TheamplitudeoftheEEGs
ignalstronglydependson
thelevelofsynchronisationoftheunderlyingneuronsandi
sattenuatedbythicklayers
oftissue(uid,boneandskin).TypicalEEGamplitudesareo
ftheorderofmicrovolts
(
V
).ExamplesofadultandneonatalEEGaredisplayedinFigure
2.2.Althoughadult
andneonateEEGmayappearsimilartotheuntrainedobserver
,theyareconsiderably
dierentincomposition(Volpe,2008),withtheneonatalEE
Gexhibitingmorecomplex
behaviourthanthatofadultEEG.However,neurologicaleve
ntdetectionsystemsdesigned
withadultEEGhavebeenshowntoworkeectivelywithneonat
alEEG(Gotmanetal.,
1997)andviceversa(Fauletal.,2009).

2.3WhatareEEGartefacts?

AnEEGartefactisanyelectricalpotentialappearingonthe
EEGtracethatarisesfrom
asourceotherthanthebrain(SaneiandChambers,2007).Art
efactsareprevalentin
EEGrecordingsduetothelowpotentialdierenceofEEGsign
als(
˘
V
),whichcan
easilybeswampedbyelectricalnoisefromnon-cerebralsou
rces.However,thedenition
ofwhatconstitutesanEEGartefactcanvaryslightlywithap
plication.Mostnotably,
inneurologicaleventdetectionsystems,someauthorsexte
ndartefactstatustosignals
emanatingfromcerebralsourcesotherthanthoseunderinve
stigation,e.g.Mitraetal.
8



Figure2.2:ExamplesofnormalbackgroundEEGforanadultpa
tient(a)andaneonatal
patient(b).(a)NormalbackgroundadultEEGrecordedusing
aViasysNicoletEEG
machineintheDepartmentofNeurologyatCorkUniversityHo
spital.ThedisplayedEEG
issampledatafrequencyof250Hz.(b)Normalbackgroundneo
natalEEGrecordedusing
aNicOneEEGmachineintheneonatalintensivecareunitatCo
rkUniversityHospital.
TheEEGissampledfrequencyof256Hz.
9
(2009)deembi-frontaldeltaactivitytobeartefactinthei
rneonatalseizuredetection
system.Conversely,otherauthorsdonotincludecertainno
n-cerebral,electricalsignals
intheartefactclass,e.g.insleepstageclassication,el
ectrocularpotentialscanbeused
tosignifyREMsleepandarethusdeemednon-artefact.Inthi
sthesis,however,the
mostcommondenitionofartefactwillbeemployed;namely,
anEEGsegmentwillbe
deemedartefactifitarisesfromasourceexternaltothebra
in.Theseartefactscanbe
broadlydividedintotwosub-categories:physiologicalan
dnon-physiological.Physiological
artefactsarisefromnon-cerebral,electricalsignalswit
hinthebody.Non-physiological
artefactsoriginatefromelectricalsourcesexternaltoth
ebody.
2.3.1Physiologicalartefacts

Ocularartefacts

Artefactsproducedbyverticalandlateraleyemovementsar
eextremelycommoninthe
EEG.Theeyeballactsasanelectricaldipolewithapositive
polelocatedatthecornea
andanegativepolepositionedattheretina(Pictonetal.,2
000).Whentheeyeballrotates
aboutitsaxis,itgeneratesalarge-amplitudealternatecu
rrenteld,whichisdetectable
byanyelectrodesneartheeye.Theelectrodesthatdetectth
eocularphenomenonmost
prominentlyaretheonesthatareclosesttotheeyeballs,na
melythefrontalelectrodes:
FP1,FP2,F7,andF8.

Verticaleyemovements
aretypicallyobservedwithblinks.Ablinkcausestheposit
ivepole
(atthecornea)tomoveclosertofrontopolar(FP1-FP2)elec
trodes,producingsymmetric
downwarddeections.Duringdownwardeyemovementtheposi
tivepole(atthecornea)
movesawayfromfrontopolarelectrodes,producinganupwar
ddeectionbestrecordedin
channelsFP1andFP2.

Lateraleyemovements
mostlyaectlateralfrontalelectrodesF7andF8.Duringal
eft
lateraleyemovement,thepositivepolemovestowardF7anda
wayfromF8.Electrodes
FP1andFP2remainlargelyunchanged.Examplesofeyeblinka
ndlateraleyemovement
artefactsaredisplayedinFigure2.3.
10
Figure2.3:EEGsampleshowinganumberofinstancesofeyebl
inksandlateraleyemove-
ments.TheEEGwasrecordedusingaViasysNicoletEEGmachin
eintheDepartment
ofNeurologyatCorkUniversityHospital.ThedisplayedEEG
issampledatafrequency
of250Hz.

Muscleartefacts

Myogenicpotentialsduetotheringofmuscleslocatedonor
closetothescalpareamajor
causeofartefactinEEG.Frontalisandtemporalismuscles,
activatedwithclenchingof
thejaworraisingoftheeyebrows,arecommoncauses.Muscle
orelectromyogram(EMG)
artefactsarepredominantlyhighfrequencysignalswhosea
mplitudescanvarydepending
onthemuscleinquestionsaswellasthestrengthofmuscler
ing(Goncharovaetal.,
2003).AnexampleofEMGartefactarisingfromheadmovement
isdisplayedinFigure
2.4.

Cardiacartefacts

Cardiacartefactsarisefromtheelectromagneticeldprod
ucedbytheheartandcantake
twoforms:electrocardiogram(ECG)artefactsandpulseart
efacts.ECGartefactsare
causedbytheelectromagneticeldoftheheart,whosepoten
tialvariesoverthesurface
11



Figure2.4:EEGsampleshowingartefactsarisingfromheadm
ovements.TheEEGwas
recordedusingaViasysNicoletEEGmachineintheDepartmen
tofNeurologyatCork
UniversityHospital.ThedisplayedEEGissampledatafrequ
encyof250Hz.
ofthescalp.ECGartefactsoftenshowupintheEEGassingle,
regularlyspacedsharp
waves,thatcorrespondwiththeQRScomplexoftheECGchanne
l,andtypicallyrange
insizefromthreehundredtimessmallerthantheEEGtosizes
comparabletotheEEG
signal(Devuystetal.,2008).AnexampleofECGartefactapp
earingonalooseelectrode
isdisplayedinFigure2.5.Pulseorballistocardiogramart
efactsoccurwhenanEEG
electrodeisplaceddirectlyoverapulsatingartery,becom
ingprominentiftheelectrode
islooselyapplied.Thepulsationcancauseslowwavesthatm
aysimulateEEGactivity,
suchasthatdisplayedinFigure2.6.LikeECGartefacts,the
reexistsadirectrelationship
betweenthetimingofECGandthepulsewavesappearingonthe
EEG;theQRScomplex
slightlyprecedesthepulsewaves.

Respirationartefacts

Respirationartefactsoccurduetomovementofanelectrode
withinhalationorexhalation.
Thiscanmanifestitselfinoneoftwoways:therstofthesei
sarespirationartefacttaking
theformofslow,rhythmicEEGactivity,synchronouswithth
ebodymovementsassociated
12


Figure2.5:LooseelectrodeonchannelT4-C4,resultinginh
ighfrequencynoiseandpulseartefact.TheECGtrace(red)s
howstheQRS
complexprecedingtheECGby200-300ms.
13

Figure2.6:PulseartefactonneonatalEEGrecording;visib
leonchannelsC4-CzandCz-C3(red)manifestingasaslowwav
e.TheECG
trace(black)showstheQRScomplexprecedingthepulsearte
factby200-300ms.
14
withbreathingandmechanicallyaectingtheimpedanceof(
usually)oneelectrode.An
exampleofslow-waverespirationartefactisdisplayedinF
igure2.7,whereelectrodeC4
hasrecordedrespirationartefactthatconsequentlyappea
rsonchannelsF4-C4andT4-
C4,andtoalesserextentonchannelsC4-P4andC4-Cz.Asecon
dformofrespiration
artefact,whichisespeciallycommoninneonatalEEG,canbe
sloworsharpwaves(suchas
thatdisplayedinFigure2.8)thatoccursynchronouslywith
inhalationorexhalationand
involvethoseelectrodesonwhichthepatientislying.This
formofrespirationartefact
canoftenmimicneonatalseizure.

Electrodermalartefacts

Electrodermalorsweatartefactscanoriginatefromchange
sintheelectrolyteconcentra-
tionoftheEEGelectrodesduetosweatsecretedfromeccrine
sweatglandsonthescalp.
Theartefactsoccurwhensodiumchlorideandlacticacidfro
msweatreactwiththemetals
oftheelectrodes.Sweatartefactstaketheformoflong,slo
wbaselinesways,ofteninthe
frequencyrangeof0.25-0.5Hz.Anexampleofelectrodermal
artefactisdisplayedin
Figure2.9,whereslowbaselinedriftscanbeobservedoncha
nnelsF4-C4,F3-C3,and
C3-T3.

Glossokineticartefacts

Thetongue,liketheeyeball,actsasanelectricdipole,wit
hthetipnegativewithrespectto
thebase.Asthetipofthetonguemovesrelativetothebase,t
hisreversestheelectriceld,
andcancauseadeectionintheEEG(Vanhataloetal.,2003).
Similartotheproduction
ofocularartefacts,theglossokineticdipoleproducesabr
oadpotentialeldthatdrops
fromfrontaltooccipitalregions.Theamplitudeofglossok
ineticartefactstendstobe
signicantlysmallerthanocularartefactshowever,witht
hedropinpotentialawayfrom
frontalelectrodesbeinglesssteepforglossokineticthan
ocularartefacts.Theseartefacts
canbeintroducedbytalking,inparticularwiththeuseofth
eletter`l'.Chewingand
suckingcanalsoproduceglossokineticartefacts,oftenac
companiedbyEMGartefacts.
15

Figure2.7:Respirationartefact,manifestingasslowwave
s,onneonatalEEGrecording;electrodeC4recordstheartef
actwhichisthen
visibleonchannelsF4-C4andT4-C4,andtoalesserextenton
channelsC4-P4andC4-Cz.
16


Figure2.8:RespirationartefactonneonatalEEGrecording
;visibleonchannelsF4-C4,
C4-O2,T4-C4andC4-Cz,manifestingasslowandsharpwaves.

2.3.2Non-physiologicalartefacts

Mainsvoltage

A50or60HzartefactmayappearontheEEGlineduethemainsvo
ltage.Thisarte-
factcanbetransferreddirectlyviapowerlinesiftheEEGis
notadequatelygrounded.
Alternatively,iftheimpedanceofoneoftheactiveelectro
desbecomeslargewithrespect
tothegroundelectrode,thegroundelectrodecanactasanac
tiveelectrode,introducing
mainsvoltageartefactintotheEEG(Tatumetal.,2011).Mai
nsvoltageartefactmay
alsoappearontheEEGviatheuseofuorescentlightsorothe
relectricalequipmentin
theclosevicinityoftheEEGmachine.

Electrodepopandelectrodemovement

Anothercommonelectrodeartefactiselectrodepop,whicho
ccurswithmomentaryloss
ofcontactbetweentheelectrodeandthescalp.Thiscausesa
nabruptimpedancechange,
morphologicallyappearingassingleormultiplesharpwave
forms.Thesesharpwaveforms
aretypicallyhighamplitudeverticaltransientswhichare
usuallyconnedtoasingle
electrode.Electrodemovementoccurswhentheelectrodemo
veswithrespecttothe
scalp.Thesemovementscanproducehigh-amplitudedeecti
onsintheEEGoftheorder
17

Figure2.9:ElectrodermalartefactonneonatalEEGrecordi
ng,mostrecognisablebytheslow,baselinedriftsonchanne
lsF4-C4,F3-C3,
andC3-T3.
18
ofmilliVolts.Unlike,electrodepop,electrodemovements
deectionsareslower,usually
intherangeof1-10Hz.

Looseelectrode

Anelectrodethatisnotmakingsatisfactorycontactwithth
escalp,canleadtoan
impedancechangeontheelectrodemanifestingasaslower,m
oreprolongedEEGspike
thanthatseenduringelectrodepop.

Machineartefacts

VariousmedicaldevicesintheICUcancauseartefactsinthe
EEG.Inparticular,theuseof
automaticelectricinfusionpumpsintroducesinfusionmot
orartefact(IMA).Morphologi-
cally,IMAappearsasverybriefspikytransients,sometime
sfollowedbyaslowcomponent
ofthesamepolarity.Artefactsarisingfromtheuseofagrav
ity-fedintravenousinfusion
mayalsomanifestitselfintheEEGsignal(EgolandGuntupal
li,1983).Thisartefact,
whichisthoughttobeduetoelectrostaticchargesontheinf
usiondrops,appearsasspike-
transientpotentialsatxedintervalsthatcoincidewithd
ropsoftheinfusion.Ventilator
equipmentmayalsointroduceartefactsintotheEEG(Tatume
tal.,2011).Thisartefact
typeisoftenrelatedtotherespirationsignal,butmayvary
inmorphologyandfrequency,
basedonthemachineinquestion,theparametersofthemachi
neandtheindividual.Fi-
nally,artefactsduetomovementofotherpeopleinthevicin
ityoftheEEGrecordinghave
beenknowntointroduceelectrostaticartefactsintotheEE
G,oftenresemblinginterictal
epileptiformdischarges(Tatumetal.,2011).

IfEEGisrecordedinsideanfMRImachine,agradientartefac
tarisesduetothemagnetic
eldsofthefMRImachine.Theseartefactscanbeoftheorder
of50timestheamplitude
ofbackgroundEEGandarethefocusofagrowingresearcheld
(Grouilleretal.,2007).
2.4Artefactavoidanceandminimisation

InmanyEEGrecordings,participantsorpatientsareinstru
ctedtoremainstillandavoid
wherepossible,excessiveeyemovements,blinksandhead-m
ovements.Fromadataloss
andcomputationalperspective,artefactavoidanceisthem
ostidealmethodoftreating
19
EEGartefacts,asthepresenceofartefactsinthedataismin
imised(Fatourechietal.,
2007).However,thereareseveraldrawbackstoemployingth
isapproach.Sincemany
physiologicalsignals(suchasheartbeats)areinvoluntar
y,someartefactswillalways
bepresentinEEGsignals.Furthermore,evenwheninstructe
dtolimitheadandeye
movements,patientsoftenhavedicultyindoingsoasitisn
otalwayseasytocontrol
theseimpulses,especiallyinlongerrecordings.Thisissu
ebecomesevenmorepronounced
inthecaseofEEGmonitoringofneonatesorchildren.Asmany
eventdetectionsystems
arerecordedintheICU,avoidingcontaminationbyextra-ph
ysiologicalartefactsdueto
medicalequipmentandhealthcareprofessionalsissimplyi
mpossible.Inanambulatory
setting,whereitisintendedthatpatientsgoabouttheirda
ilylivesasnormal,artefact
avoidanceissimilarlyinfeasible.Thisthesis,therefore
,aimstoemployartefactdetection
andremovaltechniquesforthoseartefactsthatremaininth
eEEG,particularlywhen
artefactavoidanceisimpossibleorunsuccessful.Thesete
chniquesaredrawnprimarily
frombiomedicalsignalprocessingandmachinelearning.

2.5Biomedicalsignalprocessingandmachinelearning

Inthisthesis,signalprocessingtechniquesareutilisedi
nordertoreducetheeectof
artefactsontheEEG,bothfortheclinicianandalsoforauto
matedneurologicalevent
detectionalgorithms.Broadlyspeaking,artefactprocess
ingcanbedividedintotwoap-
proaches:artefactdetectionandartefactremoval.Artefa
ctdetectionisconcernedwith
mimickingahumanEEGobserverinindicatingwhichsections
oftheEEGsignalare
contaminatedwithartefact;thisprocessisautomatedwith
machinelearningalgorithms.
Artefactremovalaimstotakeadvantageofdierencesinthe
propertiesofartefactand
cerebralEEGto\clean"theEEG.

2.5.1Machinelearning

Learningfromdataisusedinsituationswherethereisnoava
ilableanalyticalsolution,but
wherethereisdatathatcanbeusedtoconstructanempirical
solution.Machinelearning
thenconcernsitselfwiththeautomationofthisprocess,i.
e.\Acomputerprogramis
saidtolearnfromexperience
E
withrespecttosomeclassoftasks
T
andperformance
measure
P
,ifitsperformanceattasksin
T
,asmeasuredby
P
,improveswithexperience
E
"(Mitchell,1997).Indoingso,theperformanceshouldgene
ralisesuchthatthesystem
20





ˆ



Figure2.10:Abasicrepresentationoflearningfromdata.
willperformwellonunseendatainstances.Thelearningpro
cessisillustratedinFigure
2.10,wheretrainingexamples(
x
1
;y
1
)
;
(
x
2
;y
2
)
;:::;
(
x
N
;y
N
)areusedtoselectasuitable
hypothesis
g
(
x
)fromahypothesisset
H
viaalearningalgorithm
A
.Theselectionofthe
hypothesis
g
(
x
)ischosenbasedonminimisinganappropriateerrormeasure
E
.Inthis
thesis,thebranchofmachinelearningknownas
supervisedlearning
isused.Insupervised
learning,thetrainingdatasetcomeswithexplicitlabelsi
ndicatingthecorrectoutputfor
thosedatapoints.Thatistosay,thedatasethasbeenannota
tedsothatamachine
learningclassierknowswhenatrainingdatapoint(featur
esextractedfromanepoch)
belongstoapredenedclass.Thelearningalgorithmthenut
ilisesthisinformationto
selecta(hopefully)optimaldecisionboundarysuchthatad
ditional,unlabelledtestdata
pointswillbeclassiedsuccessfully.

OnceartefactualsectionsofEEGhavebeenidentiedwitham
achinelearningalgorithm
thereareanumberofoptionsavailable.ArtefactEEGcouldb
ehighlightedtotheclinician
asanautomatedartefactannotator,toaidintheirdecision
making.Alternatively,sections
ofartefactEEGcouldbeautomaticallyrejectedbeforethec
linicianexaminesthedata,or
beforethedataissenttoanautomatedneurologicaleventde
tectionsystem.Thisapproach
isparticularlycommoninevokedorevent-relatedpotentia
lsapplicationsandisknownas
conventionaltrialrejection(CTR)(Luck,2005).Finally,
theartefactdetectorcouldbe
utilisedinconjunctionwithanotherclassierdesignedto
detectsomeneurologicalevent
ofinterestsuchasepilepticseizureorimaginedleft/righ
tarmmovementasusedinBCI
applications.
21
Inartefactdetectionandrejection,sectionsofEEGcontai
ningartefactareeitherhigh-
lighted(detection)orentirelydiscarded(rejection).Ow
ingtothenatureoftheEEG
recordingprocess,inpracticetheseartefact-riddensect
ionsofEEGwillcompriseboth
cerebralEEGandartefactsignalsresultinginalossofdata
.AsEEGelectrodesmeasure
theelectricalactivityonthescalp,eachelectrodemeasur
esthesuperpositionofactiv-
ityfromseveralunderlyingsources.Asdiscussed,oftenth
eseelectricalsourcesoriginate
externaltothebrain(artefacts),andthereforeareofnoin
terestinthecontextofEEG
measurements.Artefactremovalthusaimstoreversethispr
ocess,byremovingonlythat
portionofthesignalattributedtoartefact,whileleaving
thecerebralEEGlargelyintact.
Artefactremovaltechniquescanbebroadlysplitintotwoca
tegories:(i)lteringandre-
gressionand(ii)blindsourceseparation(morerecentlyre
ferredtoundertheumbrella-term
linearinstantaneousmixturemodels).

Althoughtechnicallyspeaking,allartefactremovalmetho
dsarelteringoftheEEG(in
thetime,frequencyorspatialdomains),lteringherewill
refertothosetime-frequency
methodsbasedupontheFouriertransform.Inthesemethods,
itisassumedthatthe
frequencyofartefactdierssubstantiallyfromthecerebr
alEEG.Therelevantartefactual
frequencyrangesarethenassumedtobexed(linearlterin
g),oraredeterminedfrom
additionalphysiologicalsignals(adaptivelteringandr
egression).
2.5.2Blindsourceseparation

Blindsourceseparation(BSS)isafamilyofstatisticalmod
elscorrespondingtocoordinate
transformationindataspace.Onmultivariatedata,suchas
EEG,informationfrom
severalvariables(i.e.channels)canbeusedtoconstructm
oreinsightfulnewvariables
byapplyingacoordinatetransformationtothedata(Comona
ndJutten,2010).Inthe
contextofartefactremoval,thiscantranslatetothesepar
ationofthecontributionof
corticalsignalsandartefact.TheEEGmeasurementsignals
X
canthusbemodelledasa
lineartransformationoflatentvariables
Y
correspondingtotheactualunderlyingcortical
signalsaswellaselectricalsignalsarisingfromnon-cere
bralsources,suchasheart,eyes
ormuscletissue.Thislineartransformationofthe
N
-channelEEGisthereforemodelled
byanunknown,full-rank,
mixingmatrix
,
A
,suchthat:
X
=
AY
;
(2.1)
22
where
A
2
R
N

N
.Inthepresenceofsamplesarisingfrom
X
,thegoalofBSSistherefore
toestimateaninverseof
A
thatallowstheaccuraterecoveryofthelatentvariables
Y
.In
otherwords,ndthetransformation
A

1
tocoordinatescorrespondingtotheunderlying
corticalsignalsaswellasartefactsources.

Tondasuitable
de-mixing
matrix
A

1
requiresfurtherassumptionsonthestatistical
propertiesofthelatentvariables
Y
aswellasassumptionson
A

1
.Dieringassumptions
allowsdierentcoordinatetransformationsandgivesrise
toaplethoraofavailableBSS
algorithms,amongwhichindependentcomponentanalysis(I
CA),principalcomponent
analysis(PCA)andcanonicalcorrelationanalysis(CCA)ar
eperhapsthemostcommonly
used.DuetotheprominenceofICA-basedmethodsintheliter
ature,thefollowingpara-
graphsprovideabriefintroductiontoindependentcompone
ntanalysis;forsimplicity,in
eachcaseitisassumedthatthenumberofsources
M
isequaltothenumberofchannels
N
.WhileinmanyEEGrecordinginstances
M
maynotinfactbeequalto
N
James
andHesse(2005)showsthatthisassumptionsperformssuci
entlyformostscenariosand
where
M>N
,apre-processingdimensionalityreductionstepcanbeper
formed(typically
withPCA).

Independentcomponentanalysis

Independentcomponentanalysis(ICA)isacomputationalme
thodforseparatingamul-
tivariatesignalintoadditivesubcomponentsthatsuppose
sthemutualstatisticalinde-
pendenceofthenon-Gaussiansourcesignals.ICAcanbespli
tintotwomainsteps:(i)
whiteningoftheEEGobservationssothatsignalsarenormal
isedanduncorrelatedand
(ii)anorthogonaltransformationofthewhitenedsignalso
astomaximiseindependence
betweenthesignals.

TherststepinICAisthatof
whitening
,i.e.multiplicationoftheEEGsignals
X
bya
whiteningmatrix
W
suchthat:
Z
=
XW
;
(2.2)
and,
W
=
cov
(
X
)

1
=
2
:
(2.3)
Whiteningensuresthatthecovariancematrixof
Z
istheidentity,andthereforethatthe
signalsareuncorrelatedandnormalized.
23
ThesecondstepinICAthenisanorthogonaltransformation(
i.e.atransformationthat
leavesthecovarianceunchanged)of
Z
soastomaximisetheindependencebetweensignals:
Y
=
RZ
;
(2.4)
where
RR
T
=
I
.Maximisingtheindependenceofsourcescorrespondstomin
imisingthe
mutualinformation,
MI
=
M
X
j
=1
H
(
^
y
j
)

H
(
^
Y
)
;
(2.5)
betweenestimatedsources,where
H
(
:
)istheentropy,
^
Y
aretheestimatedsourcesand
^
y
j
arethecolumnsof
^
Y
.Findingtheoptimalrotationmatrix
R

togivethemaximally
independentsourceestimates
^
Y
becomesanoptimisationproblemsuchthat:
R

=argmin
RR
T
=
I
MI
(
^
y
1
;:::;
^
y
M
)(2.6)
=argmin
RR
T
=
I
M
X
j
=1
H
(
^
y
j
)

H
(
^
Y
)
;
(2.7)
Since
^Y
isobtainedfromtheobservedEEGsignals
X
bythelineartransformation
R
:
R

=argmin
RR
T
=
I
M
X
j
=1
H
(
^
y
j
)

H
(
X
)

logdet
R
;
(2.8)
andsincetheentropyof
X
doesnotdependon
R
anddet
R
=1(asitisarotation):
R

=argmin
RR
T
=
I
M
X
j
=1
H
(
^
y
j
)
:
(2.9)
Ofalldistributionswithagivenvariance,theGaussiandis
tributionistheonewiththe
highestentropy.Negentropy
J
measuresthedierenceinentropybetweenagivendistri-
butionandtheGaussiandistributionwiththesamevariance
.Thus,itfollowsfromthe
denitionofnegentropythat:
R

=argmin
RR
T
=
I
M
X
j
=1

H

N
(

(
^
y
j
)
;cov
(
^
y
j
))


J
(
^
y
j
)

:
(2.10)
24
AstheentropyofaGaussiandistributionisinvariantunder
therotation
R
,
R

=argmin
RR
T
=
I
M
X
j
=1

J
(
^
y
j
)
:
(2.11)
Insummary,minimisingthemutualinformationisequivalen
ttomaximizingthedistance
toaGaussiandistributionoftheindividualsources,asmea
suredbythenegentropy.This
optimisationcanthenbeachievedbygradientdescent(Bell
andSejnowski,1995).Inaddi-
tiontotheapproachoutlinedabove,therearemanyalternat
ivemethodsofimplementing
ICAbaseduponeitherdirectminimisationofthemutualinfo
rmationorbymaximisation
ofthenon-Gaussianityofthesources:e.g.byapproximated
iagonalisationofthefourth-
ordercumulanttensor(kurtosis)(CardosoandSouloumiac,
1993),orbydeation-type
xed-pointalgorithms(HyvarinenandOja,1997).

2.6Manualandsemi-automaticartefactremoval

TheblindsignalprocessingtechniquesmentionedinSectio
n2.5wereinitiallyusedto
allowtheclinicianorresearchertomanuallyremoveartefa
ctsfromcontaminatedsections
ofEEG.Thesemethodsoerthepossibilityofremovingartef
actswhileretainingthe
underlyingcerebralportionofsectionsofEEGcontaminate
dbyartefact,thusreducing
thepotentialfordiscardingclinicallyrelevantEEGastak
esplaceinCTRorlinearltering.
Inepilepsyresearchinparticular,alargebodyofliteratu
rehasbeenpublishedoutlining
semi-automaticmethodsofcleaningtheEEGusingblindsour
ceseparationBSStech-
niques.Inthesemethods,themulti-variateEEGsignalistr
ansformedintoestimated
sourcesignalsandatrainedelectroencephalographercant
henidentifyandremovethose
componentscorrespondingtonon-cerebralsources.Therem
ainingnon-artefactsources
canthenberecombinedtogivea\cleaned"EEGsignal.Follow
ingtheintroductionofap-
plyingindependentcomponentanalysistoEEGdata(Makeige
tal.,1996;Vigario,1997)
anarrayofmethodsusingICAtoremoveartefactsfromtheEEG
havebeenpublished.
Delormeetal.(2001)introducedanartefactremovaltechni
queusingICAandhigher
ordercomponents.Nametal.(2002)haveusedICAtoremovear
tefactualsourcesfrom
ictalscalpEEG.Whilethebulkofblindsourceseparationte
chniquesappliedtotheEEG
artefactremovalproblemhavefocusedonICA,anumberofoth
erblindsourceseparation
techniqueshavebeeninvestigated.Jungetal.(2000)compa
redtheeectivenessofPCA
andICAinremovingocularartefactsfromEEGandfoundthatI
CAwassuperior.
25
Whileutilisingblindsignalseparationtechniquesrepres
entedastepforwardindealing
withEEGartefacts,(inthesensethatitisnolongernecessa
rytocompletelydiscardany
sectionofEEGcontainingartefactorlosesignicantEEGin
formationviaattenuationby
ltering),therequirementofmanuallyidentifyingandrem
ovingartefactsourcesistime-
consuminganddicult.Consequently,attemptshavebeenma
detosimplifythistaskfor
theresearcherorclinicianbyprovidinginformationastow
hichsourceslikelycorrespond
toartefact,oreventoperformingautomatedartefactremov
alinclear-cutcases.These
methodsarereferredtohereassemi-automatedartefactrem
ovaltechniquesastheyvastly
reducethecomplexityoftheartefactremovaltask,albeitw
ithsomenecessaryinputby
theclinician/researcher.Iriarteetal.(2003)andUrrest
arazuetal.(2004)implemented
semi-automaticmethodsofremovingEMGandocularartefact
sfromictal,scalpEEG
withICA.Qualitativeresultsshowedimprovementinepilep
ticseizureclarity,asgraded
byaclinician.Liuetal.(2004)introducedablindsourcese
parationtechniqueforsemi-
automaticartefactremovalforintra-cranialEEGonepilep
ticpatients.Asimilarmethod
wasproposedbyCamposViolaetal.(2009)toreduceocularan
dECGartefactsfrom
EEGforevent-relatedpotentialsapplications.

Semi-automaticartefactremovaltechniquesarenotlimite
dtoICA.Illeetal.(2002)
outlinedasemi-automaticmethodofusingprincipalcompon
entanalysisandspatiallters
toremoveocularartefactinpatientsundergoingepileptic
seizure.DeClercqetal.(2006)
usedcanonicalcorrelationanalysistocreateasemi-autom
aticmethodofremovingmuscle
artefactfromEEG;inthatexperiment,CCAoutperformedlin
earlteringandamanual
ICAmethod,incleaningsectionsofEEGinpatientswithrefr
actorypartialepilepsy.
DeClercqetal.(2006)proposedthatthelowautocorrelatio
nofmuscleartefactsources
comparedtoictalsourcesmakesCCAattractiveforitsremov
alfromictalEEG.This
methodwasrepeatedbyVergultetal.(2007)onalargerdatas
etwithsimilarqualitative
results.Similarly,Crespo-Garciaetal.(2008)showedthe
usefulnessofsemi-automatic
ICAandsecondorderstatistical(SOS)algorithmsinremovi
ngmuscleartefactforsleep
research.

Asthesemethodsrequireaclinician/researchertohelpdi
erentiatebetweencerebral
andartefactsourcesofthedecomposedEEG,theyareunsuita
bleforuseinautomated
neurologicaleventdetectionalgorithms.Theydohoweverh
ighlightthefactthatifartefact
sourcescanbeaccuratelyidentied,theyoermuchpotenti
alforautomatedneurological
eventdetectionsystems.Areviewofmethodsthatoerfulla
utomationareoutlinedin
Section2.7.2.
26
2.7AutomatedEEGartefactdetectionandremoval:Are-
view
Artefactdetectionandremovaltechniquesdatebacktothei
ntroductionofcomputerised
EEGanalysisinthe1970's.Awiderangeoftechniqueshavebe
ensuggestedinthe
literature,primarilyintheareasofepilepsy,evokedande
vent-relatedpotentials,brain-
computerinterfaceandsleepresearch.Theearliestmethod
sinvolvedsimpleamplitude
thresholdingandlinearltering.Morerecently,advanced
signalprocessingandmachine
learningalgorithmshavebeenappliedwithreasonablesucc
ess.AsmentionedinSection
2.5,thesetechniquescanbebroadlysubdividedasfollows:
(i)automatedartefactdetection
andrejectionand(ii)automatedartefactremoval.Thefoll
owingsectionprovidesan
overviewofpublishedattemptsatautomaticallydetecting
andremovingartefactsinthe
EEG.

2.7.1Artefactdetection

Thresholdingmethods

Manyearlyartefactdetectiontechniquesadvocatedtherej
ectionofanyEEGsectionwhere
theEEGamplitudeexceededapre-denedthreshold.Theseth
resholdingmethodswere
oftenapplieddirectlytotheEEGsignal;forexampleBarlow
(1986)usedthresholding
oftheEEGamplitudetoremovedatacontaminatedwithelectr
odepopartefact.Row-
land(1968)incorporatedasimilarthresholdingmethodbyu
singadditionalphysiological
signals(EOGandEMG),andrejectedanyEEGsectionsiftheco
rrespondingEOGor
EMGsignalexceededapre-determinedthreshold.Gevinseta
l.(1977)usedthresholding
oftheEEGindierentfrequencybandstoreduceocularartef
acts.Asimilarmethodwas
employedbyPfurtschelleretal.(1996)andMcFarlandetal.
(1997)toreduceEMGarte-
factcontaminationintheEEGforBCIapplications.Anobvio
usdisadvantagetothese
thresholdingmethodsisthattheydonotallowtherejection
ofcontaminatedtrialswhen
EOGorEMGamplitudeissmall(Rowland,1968;CroftandBarry
,2000).Inevokedand
event-relatedpotentialsresearch,Junghoferetal.(200
0)oeredanalternativetosimply
neglectingchannelsthatwerecontaminatedbyartefactbyr
eplacingrejectedsectionsof
oneEEGchannelwithanaggregatedEEGrepresentationtaken
fromnearbychannels.
Similarly,Mouradetal.(2007)proposedanalternativetor
ejectinghighamplitudeEEG
signals,wherebyasmoothingmatrixwascalculatedtorepla
ceanyhighamplitudeEEG.
27
However,thesemethodswereintroducedforhigh-densityel
ectrodeplacementsandare
insucientifartefactsappearsimultaneouslyonmultiple
channelsandareunsuitablefor
recordingswhereelectrodenumbersarelimited(suchasinm
anyclinicalset-upsandin
allneonatalEEGrecordings).

Machinelearningforartefactdetection

Epoch-basedartefactrejectionsystemssegmenttheEEGint
oshortwindowsandreject
theseepochsifartefactisdetectedwithinthem;thisCTRap
proachisespeciallypop-
ularinevent-relatedpotentialsresearch.Fujiokaetal.(
2011)comparedthismethod
toindependentchannelrejection(Heetal.,2007)andartef
actblocking(Mouradetal.,
2007),andfoundthatrejectingepochsissuboptimalifthes
ignal-to-noiseratioislow.In
sleepresearch,Brunneretal.(1996)proposedasimplethre
shold-basedclassiertodetect
EMGartefactsbycomparingspectralEEGfeaturestothesame
featuresextractedfrom
backgroundEEG.Similarly,Durkaetal.(2003)usedasimple
classier-basedmethod
ofremovingocularandmainsvoltageartefactsinpolysomno
graphicrecordings.Inthis
system,anumberoffeatureswereidentiedascorrelatingw
ithartefact,andathreshold
wasusedtoseparatebetweenclasses.Whilestatisticalthr
esholdingmaybeareason-
ablerstapproachtoartefactdetection,especiallyforre
jectingsectionsofhighlycon-
taminatedEEG,singlefeaturesdonotprovidesucientinfo
rmationfordistinguishing
betweenartefactandnon-artefactinmostcases.Thisfacti
stakenintoaccountbyDurka
andBlinowska(1996),whoproposedaneuralnetworkclassi
ertoidentifyEEGcontain-
ingocularartefacts.ResultsforclassicationofrawEEGp
erformedbelowchancefor
testdata;however,bypre-processingtheEEGusingwavelet
analysis,71%ofartefact
epochswerecorrectlyclassied(truepositives)and82%of
normalEEGwascorrectly
classied(truenegatives).Thismethodispromisinginter
msofitsabilitytoaccurately
detectEEGartefacts;however,ithasbeendemonstratedtod
etectocularartefactsalone,
intheabsenceofanyotherneurologicaleventtobedetected
.
2.7.2Artefactremoval

Automatedartefactremovaltechniquescanbebroadlysplit
intotwocategories:(i)lter-
ingandregressionand(ii)blindsourceseparation.
28
Filteringandregression

Acceptedmethodsofremovingnon-physiologicalartefacts
tendtobestraightforward,with
mainsandmachineartefactoftenremovedbysimple,linear
lteringattherequiredfre-
quencycut-o,andelectrodepopandelectrodemovement,re
movedbyrejectingsections
ofEEGwhereanamplitudethresholdisexceeded.Duetotheva
riabilityinthemor-
phologybetweenandwithinphysiologicalartefacttypes,t
hemajorityofartefactremoval
techniquesaretailoredtoremovingphysiologicalartefac
ts.
Linearltering
isusefulforremovingartefactslocatedwithinspecicfre
quencybandsthat
donotoverlapwiththoseoftheneurologicalphenomenaofin
terestandthatdonotvary
withtime(Barlow,1984;IvesandSchomer,1988).Acceptedm
ethodsofremovingnon-
physiologicalartefactsthustendtobestraightforward,w
ithmainsandmachineartefact
oftenremovedbysimple,linearlteringattherequiredfre
quencycut-o.Linearltering
wascommonlyusedinearlyclinicalstudiestoremoveartefa
ctsinEEGsignals(Gotman
etal.,1973).Traditionally,low-passltershavebeenuse
dtoremoveEMGartefactsand
high-passltershavebeenusedtoremoveEOGandsweatartef
actsaswellasEEGbaseline
drift.Theprimaryadvantageoflinearlteringisitssimpl
icity.Asecondarybenetisthat
additionalphysiologicalinformationintheformofEOGorE
MGsignalsarenotnecessary
toremovetheartefacts.However,linearlteringfailswhe
ntheneurologicalphenomenon
ofinterestandartefactlieinsimilarfrequencybands(deB
eeretal.,1995).Alookat
thefrequencyrangesofneurologicalphenomenausedinneon
atal(0-32Hz)andepileptic
(0-64Hz)EEGshowsthatforocular(0-16Hz),muscle(10-100
Hz),cardiac(1-3Hz)and
respiration(0-12Hz)artefactsthisisusuallythecase(Vo
lpe,2008;RowanandTolunsky,
2003;Cacioppoetal.,2007).Asaresult,asimplelteringa
pproachtoremoveEMGor
EOGartefactsmayleadtothelossofvaluableneurologicali
nformationintheprocess.
AfurtherdrawbackofusinglinearlteringtoremoveEMGart
efacthasbeendetailed
byseveralauthorswhohavedescribedhowlow-passltering
ofEEGcontainingmuscle
artefactsmaycausethelteredsignaltocloselyresemblee
pilepticactivity(Klass,1995).
Furthermore,linearlteringaloneoersnosolutiontosit
uationswherethefrequency
rangeoftheartefactchangesovertime,orwherelteringis
requiredonlywhenartefact
ispresent.

Multimodalregression
and
adaptiveltering
usingalinearcombinationoftheartefact-
contaminatedEEGsignalandanartefactreferencesignalar
ecommonmethodsforuse
inremovingocularandcardiacartefacts.Ifareferencesig
nalforanartefactisavailable
29
(andthemorphologyofthatreferencesignalissimilartoth
atoftheEEGartefact),itcan
beremovedfromtheEEG,eitherbysubtractionafterscaling
itbyanappropriatefactor
(regressioninthetimedomain)orbyadaptingthelterpara
metersbasedontheaddi-
tionalphysiologicalsignal(adaptivelteringandregres
sioninthefrequencydomain).In
thismanner,ocularartefactswereremovedfromtheEEGusin
gregressionwiththeEOG
signalineitherthetimedomain(Grattonetal.,1983)orthe
frequencydomain(Whitton
etal.,1978).AcomparisonbetweenseveralEOGminimizatio
nmethodsbasedonregres-
sionanalysisintimeand/orfrequencydomaincanbefoundin
Jervisetal.(1988)and
Bruniaetal.(1989).CroftandBarry(2000)oeramoreup-to
-datecomparisonofocular
artefactremovaltechniques.Sincethen,Schlogletal.(2
007)producedawidely-cited,
fullyautomatedocularremovalsystemusingregressionwit
htheEOGsignal.However,
intheabsenceofdedicatedEOGchannels,thisapproachiscl
earlynotfeasible.
LinearregressionbecomesmorechallengingforEMGartefac
ts,sincetheyhavenosin-
glesuitablereferencechannel(Barlow,1986)andapplying
regressionusingsignalsfrom
multiplemusclegroupsrequiresmultiplereferencechanne
ls(Jungetal.,1998).Removal
ofcardiacartefactsposesadierentproblem,inthatthear
tefactsoftenappearmorpho-
logicallydierenttotherecordedECGsignal.Todealwitht
his,Strobachetal.(1994)
suggestedusingtheECGreferencesignalasatriggertoanar
ticialECGartefactrefer-
encemodelsignaltoremoveECGartefactfromtheEEGusingli
nearregression.When
anECGspikewasdetected,anECGartefactsignalwasgenerat
edfromareferencemodel,
scaledtothedetectedECGsignalandwasthensubtractedfro
mtheEEGsignal.Sahul
etal.(1995)presentedanadaptivenoisecancellerforECGa
rtefactsuppressioninsleep
EEG,reportingslowlychanginglterweightsoverthenight
.
Aninherentdrawbackofallartefactremovaltechniquesist
hepotentiallossofEEGdata.
BergandScherg(1994)showedthatastheEOGsignalcontains
contaminationbyEEG,
EOGsubtractioncanthusresultinaconsiderabledistortio
nofrelevantbrainsignals.
Despitethis,regressionandadaptivelteringremaincomm
onartefactremovaltechniques
inmanyapplications(Sahuletal.,1995;Heetal.,2004;Rom
eroetal.,2009;Molla
etal.,2012).Afurtherdrawbackstemsfromthefactthatmos
tlinearregressionand
adaptivelteringtechniquesrequiretheuseofadditional
physiologicalreferencesignals
toremoveartefacts.Intheabsenceofthesesignals,orwher
ethosesignalsthemselves
becomecorruptedwithartefact,regressionandadaptivel
teringtechniquesbreakdown.
ApotentialsolutiontothisproblemwasproposedbyJianget
al.(2007)whousedthe
wavelettransforminadditiontoadaptivethresholdingtor
emoveECGartefactsfrom
30
EEG,withoutuseofanECGsignal.

Blindsourceseparation

InSection2.6,anumberofmanualandsemi-automaticmethod
sofEEGartefactremoval
usingblindsourceseparationwerediscussed.However,ifa
nartefactremovalstageistobe
incorporatedwithanautomaticneurologicaleventdetecti
onsystem,theartefactremoval
stagemusttoobeautomated.SeveralfullyautomatedBSSart
efactremovaltechniques
havebeenpresentedintheliterature,andoerpotentialfo
rpre-processingtheEEGin
automatedneurologicaleventdetectionsystems.

OneapproachtoautomatingartefactremovalusingBSShasbe
entotakeadvantageof
additionalphysiologicalsignalsthatmeasuretheartefac
tinquestion.Inthismanner,Jung
etal.(2000)combinedICAandlinearregressionwiththeEOG
signaltoremoveocular
artefacts.Similarly,Kladosetal.(2011)introducedREG-
ICAwhichusedregressionof
theEOGsignalandtheindependentcomponentsinordertorem
oveocularartefacts.Park
etal.(2003)usedICAtoautomaticallyremoveocularartefa
ctsbyremovingcomponents
thatwerehighlycorrelatedtotheEOGreferencesignals.Jo
yceetal.(2004)proposeda
similartechniquetoremoveocularartefactsusingICA,the
EOGsignalandsomefrequency
spectrumthresholding.JamesandGibson(2003)proposedte
mporallyconstrainedICA
asatechniquethatincorporatesthereferencesignalintot
heICAalgorithmtoremove
ocularandECGartefactsfromtheEEG.Similarly,Devuystet
al.(2008)usedamodied
versionofICAtoimplementanautomaticensembleaveragesu
btractionoftheECGsignal
fromindependentcomponentstoremoveECGartefacts.DeVos
etal.(2011)proposed
acombinationoflteringandcorrelationwiththerelevant
polygraphysignaltoremove
cardiacandrespirationartefactsfromneonatalEEG.

AdisadvantageofmanyautomatedICAartefactremovaltechn
iquesistheneedforad-
ditionalphysiologicalsignals.Inmanysettingstheavail
abilityofsuchsignalsisnot
possible.Delsantoetal.(2003)andMognonetal.(2011)imp
lementedautomaticrecogni-
tionofocularartefactsextractedbyICAusingacombinatio
nofspectralfeatures,spatial
topography,andtime-domainsignalmorphology,withoutus
eoftheEOGreferencesig-
nals.Nazarpouretal.(2008)used
apriori
informationregardingthespatialdistribution
oftheocularartefacttoaidinitsidentication,alsowith
outuseoftheEOGreferencesig-
nals.Similarly,ZhouandGotman(2009)proposedanautomat
edICAmethodtoremove
ocularartefactswithouttheEOGsignal,basedonadipolemo
deloftheeye.Fauletal.
31
(2005b)introducedanICA-basedmethodwhereartefactswer
eindirectlyremovedwhen
ICswererankedbasedonfeatureswhichwereknowntodescrib
eneonatalseizure.Zhou
andGotman(2004)usedacombinationofICAandwavelettrans
formtoautomatically
removemuscleartefactswithouttheuseofadditionalphysi
ologicalsignals.
Intheabovemethods,heuristicsandthresholdswereusedto
identifyartefactualindepen-
dentcomponents;however,machinelearningtechniquesout
performsimplethresholding
whenthefeatureinquestiondoesnotclearlyseparatebetwe
enclasses(i.e.artefactand
non-artefactICs).Thatistosay,machinelearningalgorit
hmsperformseparationbased
onseveralfeaturesatonce,wheregreaterseparabilitymay
exist.FortypicalEEGarte-
factsasinglefeatureisnotenoughtoprovidesucientlyac
curateseparationbetween
normal,seizureandartefactEEG.Shokeretal.(2005)propo
sedafusionofblindsource
separationandsupportvectormachinestoremoveocularart
efactsfromtheEEG.Halder
etal.(2007)proposedasimilarmethodforaBCIapplication
.LeVanetal.(2006)com-
binedblindsourceseparationintheformofICAwithaBayesi
anclassiertoeectively
detectartefactsinictalEEG.Shaoetal.(2009)pairedICAw
ithanumberofdierent
classierstoremoveocularandECGartefacts.Morerecentl
y,Nolanetal.(2010)and
Winkleretal.(2011)introducedmethodsofautomaticallyr
emovingEEGartefactsfor
anevent-relatedpotentialandBCIapplications,usingICA
andstatisticalthresholdingof
featureswhichareknowntodescribeartefact.Thesemethod
sholdconsiderablepoten-
tialforartefactprocessinginautomatedEEGdiagnosticsy
stems;however,theyrelyon
accuratelyannotatedICA-decomposeddata,somethingwhic
hisoftenunavailable.
Principalcomponentanalysis
(PCA)isanotherstatisticaltechniquethathasbeenusedfo
r
blindsourceseparationoftheEEGintouncorrelatedestima
tedsourcecomponents.Lins
etal.(1993)andLagerlundetal.(1997)showedthatusingPC
A,ocularartefactcompo-
nentscanbeidentiedandremoved,especiallyiftheirampl
itudeishigh.Morerecently,
Schachingeretal.(2007)usedPCAtodecomposethesignalin
tosub-bandsandappliedan
adaptiveltertoreducehigh-amplitudeartefacts.Howeve
r,PCAsuersfromanumber
ofrestrictionsinremovingEEGartefacts.LamotheandStro
ink(1991)showedthatthere
doesnotexistaone-to-onecorrespondencebetweenprincip
alcomponentsandindividual
cerebralsources,makingitgenerallyinappropriatetoasc
ribephysiologicalsignicance
directlytotheindividualcomponents.Furthermore,Lager
lundetal.(1997)showedthat
PCAcannotcompletelyseparateeye-movementartefactsfro
mtheEEGsignalwhenthey
havecomparableamplitudes.NotethatPCArefersheretoits
directuseinblindsource
separation;PCAisalsooftenusedfordimensionalityreduc
tion,transformingdatainto
32
alowerdimensionrepresentationbaseduponthedirections
ofmaximalvarianceinthe
data.WithinthescopeofEEGprocessing,PCAisoftenusedas
apreprocessingstep
toICA(toselectonlythosecomponentswiththemostvarianc
eforICA).Alternatively,
PCAisoftenusedasafeaturereductiontechniquebeforemac
hinelearningclassication
(toselectthosefeatureswiththemostvariance).

Severalotherartefactremovaltechniqueshavebeenapplie
dtoEEGdatawithvarying
success.Gaoetal.(2010)showedthatcanonicalcorrelatio
nanalysisismoresuitablethan
ICAatremovingEMGartefactfromtheEEGandimplementedana
utomatedartefact
removalsystemonsimulateddatatodoso.MorerecentlyZhan
getal.(2012)demon-
stratedtheuseofCCAandtheEOGchanneltoautomaticallyre
moveeyeblinkartefacts
fromtheEEG.

Theartefactdetectionandremovaltechniquesoutlinedher
eillustratethewiderangeof
approachesthathavebeenappliedinanattempttomitigatet
heeectsofartefact.How-
ever,forthemostparttheseapproacheshavenotbeendemons
tratedfortheirabilityto
dealwithartefactsinautomatedEEGdiagnosticsystems.In
deedinmanyoftheoutlined
methods,shortcomingsinthenatureofthedataandthemanne
rinwhichthealgorithmis
evaluated,meanthatthereportedresultsmaybesignicant
lyover-optimisticinpredicting
howtheartefactprocessingmethodswouldperformaspartof
anautomatedneurological
eventdetectionsystem.Thisissuewillbediscussedinmore
detailinSection2.9.Before
thisisdone,thefollowingsectionswillintroducetheback
groundofthetwoneurological
eventdetectiontasksthatareinvestigatedinthisthesis:
automatedepileptiformactivity
detectionandautomatedneonatalseizuredetection.Abrie
foverviewofthepublished
literatureonartefactprocessingmethodsintheseparadig
msisthenprovided.
2.8EEGartefactsinautomatedEEGdiagnosticsystems

Inthisthesis,theroleofartefactdetectionandremovalis
evaluatedinthecontextoftwo
automatedmedicalEEGdiagnosticsystems:epileptiformac
tivitydetectionandneonatal
seizuredetection.Whilethetwoclassicationtasksaresi
milarinnature,therearea
numberofsignicantdierencesbetweenthem;mostnotably
,epileptiformactivitydetec-
tionrequiresthedetectionofveryshort,ofteninfrequent
neurologicaleventswhereitis
imperativetodetectallpossibleoccurrences,whereasneo
natalseizuredetectionrequires
thedetectionoflongerseizureactivity,withtheemphasis
onverylownumbersoffalse
33
detections.Consequently,dierentartefactprocessinga
pproachesmaybebettersuitedto
eachneurologicaleventdetectionsystem.Thefollowingpa
ragraphsoutlinetheproblem
thatthesesystemsaimtosolve,aswellasprovidingalitera
turereviewofthepublished
solutionstodate.Inbothcases,theroleofautomatedartef
actprocessingisalsoreviewed.
2.8.1Epileptiformactivityandepilepticseizuredetecti
on
Epilepsy

Epilepsyisoneofthemostcommonneurologicaldisordersin
humans,aectingalmost
50millionpeopleworldwide(SaneiandChambers,2007).Iti
sdenedasanunderlying
tendencyofthebraintoproducesuddenburstsofabnormalel
ectricalactivitythatdisrupt
otherbrainfunctions.Well-knowncausesofepilepsymayin
clude:geneticdisorders,trau-
maticbraininjury,metabolicdisturbances,alcoholordru
gabuse,braintumour,stroke,
infection,andcorticalmalformations(JokeitandSchache
r,2004).
Theelectroencephalogramistheprimarytoolusedinthedia
gnosisofthedisease.Diag-
nosisisbasedonthepresenceofepilepticseizureactivity
(Figure6.1)showsanexample
ofgeneralidiopathicseizureinanadultpatient),whichca
nlastfromseveralsecondsto
anhour,andalsobasedonthepresenceofshorterdurationin
terictal,epileptiformac-
tivity(Figure6.2),whichisanindicatorofsusceptibilit
ytoepilepticseizure(Chatrian
etal.,1964).Anepilepticseizureisadisturbancecharact
erizedbychangesinneuronal
electrochemicalactivitythatresultsinabnormalsynchro
nousdischargesinalargecellpop-
ulation,givingrisetoclinicalsymptomsandsigns.Patien
tsexperiencevariedsymptoms
duringseizuresdependingonthelocationandextentofthea
ectedbrainarea.Symptoms
mayincludeinvoluntaryclonicmovements,analteredstate
ofawareness,convulsions,or
impairmentofconsciousness,unusualorrepetitivebehavi
ours,oroddsensations.Seizures
canbeclassiedinseveralwaysbaseduponthesiteandexten
tofthebrainthatisaf-
fected,clinicalsymptoms,EEGpattern,andetiology(Holm
es,1997).Partialseizures
arelimitedinextent;generalizedseizurestypicallyaec
ttheentirebrainandimpaircon-
sciousness.Epileptiformactivitybycontrastareshorter
duration(usuallylessthana
second)abnormalwaveformswithnoclinicalsigns(Binniea
ndStefan,1999).
Followingareferralfromaneurophysiologist,theinitial
testforepilepsyisknownasa
routineEEG,whichlasts20-40minutesandlooksforsignsof
abnormalwaveformsinthe
recording(includingsomeorallofthefollowingfeatures:
slowwaves,spikesandsharp
34


Figure2.11:EEGshowinganexampleofageneralisedidiopat
hicepilepticseizurerecordedfromanadultpatientatCUH.
Thedatawas
recordedusingaViasysNicoletEEGmachinewithasamplingf
requencyof256Hz.
35



Figure2.12:EEGsampleshowingtwoinstancesofepileptifo
rmactivityrecordedfromanadolescentpatientatCUH.Thed
atawas
recordedusingaViasysNicoletEEGmachinewithasamplingf
requencyof256Hz.
36
waves,spike-wavecomplexes,andpolyspikes).If,attheen
dofthetest,nosuchactivity
hasbeenrecordedandepilepsyisstillsuspected,thepatie
ntmaybeaskedtoreturntothe
hospitalforalonger,continuousEEG(usuallylasting24-7
2hours);thisrecordingmay
beambulatoryandthereisconsiderableevidencetosuggest
thatitisclinicallydesirable
forittobeso(Seneviratneetal.,2013).Therecordedsigna
listhenvisuallyinspected
byaneurophysiologistforabnormalities.

Automatedepilepticseizureandepileptiformactivitydetec
tion
Duetothecostly,time-consumingnatureofthecontinuousE
EG,ithasbeenproposedthat
anEEGsystem,withthecapabilitytoautomaticallydetecte
pilepticseizureactivityas
wellastheshorterdurationepileptiformactivity,wouldb
eusefulforclinicalanddomestic
monitoringofpatients(Waterhouse,2003;GotmanandGloor
,1976;Indiradevietal.,
2008).Suchasystemwouldhelptheclinicianpinpointtheex
actlocationofabnormalities
intherecording,thusvastlyreducingpost-recordinganal
ysistime.
Automatedepileptiformdetectionsystemscanbetracedbac
ktothehalf-wavedecomposi-
tionmethodproposedbyGotmanandGloor(1976).Comprehens
ivereviewsofepileptic
seizureandepileptiformdetection(sometimesreferredto
asspikedetectioninthelitera-
ture)algorithmshavebeencompiledbyWilsonandEmerson(2
002),Cassonetal.(2009),
Halford(2009)andSong(2011).Highlightsinclude:thewav
eletdecompositionmethod
proposedbyIndiradevietal.(2008),theneuralnetworksei
zuredetectionsystemout-
linedbyBaoetal.(2008)andtheICApreprocessedmethodint
roducedbyDeLucia
etal.(2008).RecentworkbyKelleheretal.(2010)proposed
anSVM-basedclassieras
eectiveforepileptiformactivityandepilepticseizured
etection.
2.8.2EEGartefactsinepileptiformactivitydetectionsys
tems
ArtefactsarewidespreadinmostEEGrecordings,andresult
fromthewidearrayofcauses
outlinedinSection2.3.InadditiontoroutinecausesofEEG
artefacts,manyepileptic
seizuresareoftenaccompaniedbyinvoluntaryclinicalsym
ptomsthatintroduceasigni-
cantamountofartefact(Gotmanetal.,1999).Theseartefac
tscaninterferewithseizure
interpretation,especiallyiftheyarepresentatthetimeo
ftheseizureonset.Artefacts
areasignicantobstacleintheunder-performanceofmanya
utomatedepilepsydiagnosis
algorithms(WilsonandEmerson,2002).Anumberofpapersin
theliteraturepropose
37
methodsforremovingartefactsinepilepticEEG.Anumberof
manualandsemi-automated
artefactremovaltechniqueshavebeendescribedinthelite
rature(Section2.6).Iriarte
etal.(2003),Urrestarazuetal.(2004)andLiuetal.(2004)
successfullyusedICA-based
semi-automaticmethodsofremovingartefactsfromEEGreco
rdingsofpatientsundergo-
ingepilepticseizurewithoutintroducingobviousdistort
iontotheseizuremorphology.Ille
etal.(2002)usedPCAtoasimilareect.DeClercqetal.(200
6)andVergultetal.(2007)
proposedsemi-automatedCCAmethodstoremoveEEGmusclear
tefactforpatientswith
refractorypartialepilepsy.

Anumberofpaperspublishedonautomatedepilepticseizure
andepileptiformactivity
detectionincludeautomatedartefactdetectionandremova
l.Intheirhalf-wavedecom-
positionmethodofinterictalepileptiformactivitydetec
tion,GotmanandGloor(1976)
introducedsomerule-basedthresholdingtechniquestorej
ectsectionsofEEGcontami-
natedwithEMGandocularartefacts.Thetechniquesoutline
dinthepaperweretailored
totheepileptiformdetectionsystemtorejectspeciccase
soffalsepositivedetectionof
spikeandsharpwaveactivity.Thesemethodswerelaterupda
tedforepilepticseizure
detection(SaabandGotman,2005).Kuhlmannetal.(2009)em
ployedthesemethods
withslightmodicationsintheirpaperonseizuredetectio
nusingseizureprobabilityes-
timation.Intheirrule-basedepileptiformdetectionsyst
em,Dingleetal.(1993)included
threshold-basedrulestailoredtoexcludesectionsofarte
factualEEG.Asimilarrule-based
methodologywasemployedbyRamabhadranetal.(1999)inthe
irautomatedepilepto-
genicfocuslocalisationsystem.Thisapproachofdealingo
nlywiththoseartefactsthat
areresponsibleforfalsedetectionsisparticularlysuite
dtoreducingthenumberoffalse
detectionsinepileptiformactivitydetectionasitisimpo
rtanttocontinuetomaintain
correctdetectionsofepileptiformevents;however,theru
le-basedapproacheslisteddonot
takeadvantageofsomeofthemostpowerfulaspectsofmachin
elearning.Analternative
approachtotacklingproblematicartefactsinepileptifor
mactivitydetectionsystemsisto
useblindsourceseparationatthepre-processingstage.In
thismanner,HesseandJames
(2007)andDeLuciaetal.(2008)usedICAtoautomaticallyde
tectepileptiformactivity
inepilepticpatients.Byapplyingthisapproach,anumbero
fEEGartefactswereimplic-
itlyexcluded,i.e.epileptiformdetectionwasperformedo
nictalindependentcomponents.
However,thesesystemswereeitherdemonstratedforverysh
ortEEGsegments(Hesse
andJames,2007)orperformedsignicantlybelowstate-of-
the-art(DeLuciaetal.,2008).
38
2.8.3Neonatalseizuredetection

Neonatalseizure

TheEEGcanbeusedtomonitorsicknewbornpatientswhoaread
mittedtotheneonatal
intensivecareunit(NICU)andareatriskofdevelopingneon
atalseizures(Murrayetal.,
2008).Theseneonatalseizuresareclinicallydenedaspar
oxysmalalterationsinneurolog-
icalfunction,i.e.analterationinbehavioural,motorand
/orautonomicfunction(Volpe,
1989).Hypoxicischemicencephalopathy(HIE)isthemostco
mmonneonatalseizureeti-
ology(i.e.cause);inducedbyimpairedgasexchangethatre
sultsininadequateoxygen
supplytothebrain(hypoxia)andneuronaldamage(ischemia
)(Volpe,2008;Pinetal.,
2009).Othercommonetiologiesarecentralnervoussystemi
nfection,cerebralinfarctions
andmetabolicabnormalities(EvansandLevene,1998;Ronen
etal.,1999).
WherevisibleontheEEG,theseseizuresmanifestasrepetit
ivepatternswithminimumdu-
rationdenedas10seconds(Clancy,2006).Amajorconfound
ingfactorinthedetection
ofneonatalseizuresisthefactthatseizuresmaynotbeclin
icallyobservable,especiallyif
thepatientisprescribedwithananti-epilepticdrug(Clan
cyetal.,1988;Byeetal.,1997).
TheEEGisthereforeconsideredthegoldstandardinneonata
lseizurediagnosis.However,
thediagnosisofelectrographicseizureisnon-trivial.Th
eappearanceofthedischargecan
transforminfrequency,amplitudeandmorphologyovertime
(MizrahiandClancy,2000).
Electrographicseizuresarepredominantlyunifocalbutmu
ltifocalseizuresmayalsooccur
indierentbrainregionsandresimultaneouslyandasynch
ronously.Bothunifocaland
multifocalseizuredischargescanspreadfromonelocation
viaabruptchangeorbygradual
widening.

Automatedneonatalseizuredetection

Strongparallelsexistbetweenautomatedneonatalseizure
detectionandautomatedepilep-
ticseizuredetection.Theseresearchareascanbetracedba
cktotheautomatedmethod
ofrecognisinginter-ictalepilepticactivityinEEGbyGot
manandGloor(1976).Au-
tomatedneonatalseizuredetectionrstappearedinthelit
eraturewithanapproachby
Liuetal.(1992)toquantifytheperiodicityoftheEEGdurin
gseizureviaautocorrelation
analysis.Gotmanetal.(1997)introducedathreshold-base
dneonatalseizuredetection
system,wherethemajorityoffeatureswereextractedfromt
hefrequencydomain.Roess-
genetal.(1998)introducedamodel-basedapproachtoseizu
redetection.Celkaand
39
Colditz(2002)proposedaseizuredetectorbasedoncomplex
ityanalysisoftheEEG.A
numberofsystemshavebeendevelopedusingwaveletanalysi
sandclassicationtodetect
neonatalseizure(Nagasubramanianetal.,1997;Zarjameta
l.,2003;Hassanpouretal.,
2004a,b).Fauletal.proposedseveraltechniquesforautom
atedneonatalseizuredetec-
tion,includinganICApre-processingstage(Fauletal.,20
05b),complexityfeatures(Faul
etal.,2005a)andaneuralnetworkclassicationstage(Fau
l,2007).Anumberofclassier-
basedmethodsforneonatalseizuredetectionhaveshownpro
misingresults.Karayiannis
etal.(2006)proposedarule-basedarchitectureincorpora
tinganeuralnetworkclassier,
Aarabietal.(2007)proposedamulti-classneuralnetworkw
ith6non-seizureand2seizure
states.Greeneetal.(2008)investigatedtheperformanceo
fanumberof2-classclassier
architectures.Morerecently,Thomasetal.(2010)andTemk
oetal.(2011b)proposeda
neonatalseizuredetectionsystembasedonGaussianmixtur
emodelsandsupportvector
machinesrespectively.

Severalmultimodalseizuredetectionsystemshavebeenout
linedintheliterature.A
video-basedmethodtoquantifymotoractivityduringclini
calseizureswasproposedby
Karayiannisetal.(2001).Datafusionmethodscombiningse
izureinformationfromEEG
andECGweredevelopedbyGreeneetal.(2007)andMalarvilia
ndMesbah(2008).
Atpresent,therelativelypoorperformanceofautomatedse
izuredetectorshasprevented
theiradvanceintowidespreadclinicaluse.Inreviewingwh
atfeatureshavepreventedthis
transitionfromresearchliteraturetoclinicalimplement
ation,Thomas(2011)haspointed
outthatneonatalseizureiscomposedofalargesetofdivers
epatternsemanatingfrom
backgroundactivity,seizureeventsandartefacts.Additi
onally,EEGcharacteristicsare
oftenconsiderablydierentbetweenpatients,andarenots
tationary,i.e.theyevolveover
time,particularlyintheimmediateweeksafterbirth.Howe
ver,Thomas(2011)found
thatthelargestcontributortofalsedetectionswasthatof
artefact,accountingfor43%
offalsepositivedetectionsofneonatalseizure.Inpartic
ularlooseelectrodeorelectrode
detachmentwereproblematic,leadingtosignicant50Hzli
nenoiseandsubsequentmo-
tionartefactastheelectrodewasfreetomove.Respiration
andmovementartefactswere
alsohighlyprominentandproblematic.Inadetailedclinic
alstudyoftheSVMclassi-
erperformanceonaneonatalcohortcollectedatUniversit
yCollegeLondonHospitals,
Mathieson(2012)foundthatcontaminationoftheneonatalE
EGbynon-cerebralelec-
tricalartefactsisthesinglelargestcauseofmisclassic
ationintheautomatedsystems
developedbyFaul(2007),Thomas(2011)andTemkoetal.(201
1b).Similarly,inthe
evaluationoftheirneonatalseizuredetectionalgorithmG
otmanetal.(1997)foundthat
40
artefactswereresponsibleforthelargestfractionoffals
edetections.
2.8.4EEGartefactsinneonatalseizuredetection

Manyautomatedneonatalseizuredetectionalgorithmsempl
oyartefactdetectionandre-
movaltechniques.Thereareclearparallelsbetweenthesea
rtefactprocessingtechniques
andthosedesignedforautomatedepilepticseizureandepil
eptiformactivitydetectionsys-
tems.Witteetal.(1987)implementedaregressionmethodfo
rECGandEOGartefacts
inneonatalEEG.Gotmanetal.(1997)incorporatedtherule-
basedthresholdingmethod
fromGotmanandGloor(1976)intoaneonatalseizuredetecti
onsystem.Moreadvanced
rule-basedartefactrejectionschemesweresubsequentlyi
mplementedbyGloveretal.
(2002)andMitraetal.(2009).Aarabietal.(2007)usedanar
rayofartefacttechniquesto
removeindividualartefacttypes.Templatematchingwasus
edtoremoveocularandECG
artefacts;thresholdinginthetimedomainwasusedtoremov
eelectrodemovementand
pop,andthresholdinginthefrequencydomainwasusedtorem
oveEMGartefact.How-
ever,theeectthateachoftheseartefactprocessingrules
producedontheepileptiform
detectionsystemswasnotquantied.Fauletal.(2005b),us
edICAtoindirectlyremove
artefactsbyperformingfeaturerankingandkeepingonlyth
oseICsthatmostresembled
neonatalseizure.

MultimodalartefactrejectionwasusedbyBoashashetal.(1
999)bycombiningthreshold-
ingmethodsfromtheEEG,EOG,ECGandvideo.Karayianniseta
l.(2006)andMitra
etal.(2009)usedsimilarapproachesbyincludingapost-pr
ocessingstagewhereseizure
decisionswererejectedifthecorrespondingsectionofEEG
washighlycorrelatedtoany
oftheECG,EMGorrespirationsignals.DeVosetal.(2011)pr
oposedanautomatedICA
methodtoremoveECG,pulseandrespirationartefacts.Inth
ismultimodaltechnique,
theindependentcomponentswerecomparedtolteredpolygr
aphysignalsandremoved
ifthecorrelationexceededapre-denedthreshold.TheseI
CA-basedmultimodalcorrela-
tionmethodsprovedeectiveinthesystemofDeVosetal.(20
11);however,thereliance
onthepresenceofarespirationtraceisproblematic,asthe
yarenotavailableinmany
NICUs.
41
2.9Datasetsandmetrics

Theprimarygoaloftheworkdetailedinthisthesisistoadva
ncethedevelopmentof
artefactprocessinginautomatedEEGdiagnosticsystems.I
ndoingso,itishopedthat
theperformanceoftheseneurologicaleventdetectionsyst
emwillimprove.Toaccomplish
this,dataisnecessary.Moreover,itisimperativethatthe
dataisrepresentativeofthe
datathatwillbeencounteredinreal-worldscenarios.

Whilethepublishedliteratureinartefactdetectionandre
movalhaveundoubtedlypro-
videdawealthofinformationandideasregardingtheproces
singofartefactsinEEG,
thereareanumberofmethodologicalshortcomingsthatarev
isibleacrossmanyofthe
papers.Mostnotably,biasesandassumptionsregardingthe
datasetsuponwhichtheal-
gorithmsaredevelopedandevaluatedareoftenignoredordo
wnplayed.Biascanenterthe
datasetsfromanumberofdirections.Firstly,isthedatare
presentativeofthatwhichwill
beencounteredinthereal-world?Themajorityofpaperspub
lishedintheliteraturethat
dealwithartefactsinEEG,dosoonsimulated,pruned,oroth
erwiseunrepresentative
EEGdata.Similarly,manypapersevaluatetheperformanceo
falgorithmsondatawhose
durationisoftheorderofseconds,ratherthanminutes,hou
rsorevendays.Further-
more,thereisoftennodiscussionastowhethertheincluded
datawasrandomlychosen
orselectedasitshowedfavourableperformancewiththeart
efactprocessingtechniquein
question.Thisthesisisfoundeduponthebeliefthatinorde
rtodealeectivelywiththe
veryrealproblemofEEGartefacts,realdata,representati
veofthatencounteredinnoisy
recordingenvironments,shouldbeusedtotrain,andmoreim
portantlytestthesignal
processingandmachinelearningtechniquesusedtoidentif
yand/orremovetheunwanted
artefacts.Wherethisisimpossible,thelimitationsofthe
conclusionsandgeneralisability
ofthealgorithmshouldbeclearlystated.

Theworkoutlinedinthisthesisfollowsthreebroadthreads
:(i)detectinghead-movement
artefactssothatautomatedneurologicaleventdetections
ystemsinambulatoryEEGcan
bedeveloped,(ii)processingofocularandmovementartefa
ctsinanautomatedepilep-
tiformactivitydetectionsystemtoreducefalsedetection
sand(iii)removingrespiration
artefactsinordertoimproveastate-of-the-artneonatals
eizuredetectionalgorithm.Sep-
arate,specicdatasetsareusedforeachofthesetasks;ine
achcase,considerableeort
wasmadetoensurethatthesedatasetswouldbeasrepresenta
tiveaspossibleofthose
encounteredinreal-world,clinicalandambulatoryenviro
nments.
42
Therstdatasetisanon-clinical,ambulatoryEEGdatasetc
ollectedatUCCin2009
usingtheEmotivEPOCheadset,andoutlinedinSection2.9.1
.Theseconddatasetused
inthisthesis,outlinedinSection2.9.2,isaclinicaldata
setcollectedfromepilepticpatients
intheneurophysiologydepartmentofCorkUniversityHospi
tal(CUH).Thenaldataset
consistsofclinicaldatacollectedfromneonatesattheneo
natalintensivecareunitsat
CorkUniversityHospitalandUniversityCollegeLondonHos
pitals,andisdescribedin
Section2.9.3.

2.9.1Head-movementartefactsinadultEEG

Priortotheworkcarriedoutinthethesis,thereexistednoa
ttemptintheliterature
todealwithhead-movementartefactsinparticularorindee
dartefactsinanambulatory
environmentingeneral.Inordertoinvestigateandexperim
entwithpotentialmethods
forEEGartefactdetectionandremoval,anon-clinicaldata
setwascollectedusingthe
EmotivEPOCheadset(EmotivEPOCheadset).The14-channelE
motivEPOCisacom-
merciallyavailableEEGheadsetrecentlyreleasedforthed
evelopmentofBCItechnologies.
TheheadsetrecordsEEGfrom14channels(AF3,F7,F3,FC5,T7
,P7,O1,O2,P8,T8,
FC6,F4,F8,AF4),sampledat128Hz,withareferentialmontag
eemployed;therefer-
enceelectrodes(P3andP4)aretakenfrombehindtheears.Fi
gure2.13comparesEEG
recordedusingtheEPOCandthatrecordedusingaViasysNico
letEEGmachine;itcan
beseenthattheEPOCprovidesEEGofcomparablequalitytocl
inicalEEGmachines.A
keyfactorinthechoiceoftheEmotivEPOCheadsetwastheinc
lusionofgyroscopesin
thedevice.Gyroscopesaredevicesthatmeasureangularrot
ation,andconsequentlyoer
ameansofaccuratelydetectingheadmovements.Figure2.14
showsansectionofhead
movementwithoneEEGchannel(blue)andtwogyroscopesigna
ls(blackandred)dis-
played.Asgyroscopesoraccelerometersarenotincludedon
anycommerciallyavailable,
clinicalEEGmachines,andethicsapprovalfortheirdeploy
mentinaclinicalenvironment
mayprovedicult,theEmotivEPOCoeredasuitable,inexpe
nsivealternative.Gyro-
scopesignalsfromthe2-axisgyroscopelocatedattherearo
ftheheadsetweresampled
at128Hz.ForbothEEGandgyroscopesignals,theamplituder
esolutionwas0.51
V
perbit.Thehead-movementartefactdatasetwascreatedwit
hthepurposeofaccurately
capturingthetypesofhead-movementartefactsthatwillbe
likelytobeencounteredina
real-worldambulatorysetting.Accordingly,twoalternat
iveswereavailableforrecording
thedata:(i)recordthedatanaturallybyallowingtheparti
cipanttogoabouttheirdaily
lifeasnormalandexaminethedataafterwardstoannotatefo
rhead-movementartefact
43



Figure2.13:ComparisonofEEGrecordedusingEmotivEPOCan
dViasysNicoletOne
EEGmachines.Approximately5secondsofnormalbackground
EEGaredisplayedfor
eachsystem.(a)NormalbackgroundEEGrecordedusingViasy
sNicoletEEGmachineat
asamplingfrequencyof250Hz.(b)NormalbackgroundEEGrec
ordedusingtheEmotiv
EPOCEEGdeviceatasamplingfrequencyof128Hz.
44
00.20.40.60.811.21.41.61.82x 1043000400000.20.40.60.811.21.41.61.82x 10410003000Samples(fs=128Hz)
00.20.40.60.811.21.41.61.82x 10410003000Gyroscope

y-direction
Gyroscope

x-direction
EEG
NodHead
ShakeHead
Figure2.14:EEGchannelF8(blue)andgyroscopex-directio
n(black)andy-direction
(red)signalsforartefactscausedbynoddingandshakinghe
ad.
or(ii)createahead-movementartefactprotocolthatdescr
ibedtypicalhead-movements
andinstructparticipantstocarryoutthemovementsatden
edtimes.Bothoptionswere
initiallyevaluatedintermsofaccuracyanddicultyandit
wasfoundthattheprimary
obstacleinusingthedata,wasthatofannotation,i.e.howa
reartefactandnormalEEG
determined.Withdatacollectionmethod(i),itwasextreme
lytimeconsumingtoexamine
theEEGandannotateforartefactsafterthefact.Important
ly,therewasnodiscernible
distinctionbetweenthetypesofartefactcreatedindataco
llection(ii)astothosecol-
lectednaturallyin(i).Thus,ahead-movementartefactgen
erationprotocolwasusedin
thecreationofanartefactdatabasesoastoaidintheannota
tionofthedata.
Anartefactgenerationprotocolwasdrawnupwhichinstruct
edtheparticipantstoperform
repetitionsofeachofthefollowingmovements:shakehead,
nod,rollhead,clenchjaw,
raiseandlowereyebrows.Betweenrepetitionsparticipant
swereaskedtoremainstillin
ordertogeneratereferenceEEG.Particularfocuswasplace
donmovementartefactsthat
havebeenobservedtooccurmoreregularlyinanambulatoryE
EGsystem.Thisartefact
generationprotocolisdescribedinmoredetailinTable2.1
.Thepaceanddirectionof
headmovementswerevariedwhereappropriateinordertoavo
idexcessivelyrepetitive,
periodicartefactsthatmaybeunlikelytooccurinanatural
ambulatoryenvironment.
Intotal,thisdatacomprisesover30minutesofheadmovemen
tdata,collectedfrom7
malehealthyadults(23-50years,meanage30).Informedcon
sentwasobtainedfromall
participants,noneofwhomhadahistoryofneurologicalorp
sychiatricdisordersandnone
wereonchronicmedication.

TheEEGartefactdatawasannotatedasartefactwherevisual
lynoticeabledeectionin
45
theEEGwasobservedatthetimesthatparticipantsperforme
dmovements.Annotation
wasindependentlyconrmedbyaspecialistclinicalphysio
logistinneurophysiology.
2.9.2OcularandmovementartefactsinepileptiformEEG

Therstclinicaldatasetusedinthisstudyconsistsofmult
i-channelEEGrecordings
obtainedfrom8patients(9-32years;meanage16),eachsue
ringfromidiopathicgener-
alisedepilepsy.ThedatawasacquiredusingaNicoletOnecl
inicalEEGmachineatthe
DepartmentofNeurophysiology,CorkUniversityHospitalf
rompatientsundergoingrou-
tineEEGtests.Eachpatientdisplayedseveralinstancesof
eitherinterictalepileptiform
activity,epilepticseizureactivity,orboth.Thedatawas
sampledat250Hzusingthe
10-20systemofelectrodeplacementandanalysedusinga16-
channelbipolarmontage.
ThisresearchworkhasbeenapprovedbytheClinicalResearc
hEthicsCommitteeofthe
CorkTeachingHospitals(CREC).

Atotalof42abnormalevents(consistingofsinglefocalsha
rp-waveandspikeandslow-
waveactivity)wereannotatedonaper-channelbasisbyatra
inedneurophysiologist.A
detailedaccountofthedataisillustratedinTable2.2.Exa
mplesofocularandmovement
artefactwerealsoobtainedfromthedataset.Theocularart
efactdataconsistsof35
expert-annotatedeventswithatotaldurationof38.9secon
ds,recordedatthe4frontal
EEGchannels(FP2-F4,FP2-F8,FP1-F3andFP1-F7).Themovem
entartefactdata
comprises14expert-annotatedeventsoftotalduration79.
5seconds,takenfromall16
EEGchannels.
Table2.1:ArtefactGenerationProtocol.
Head-movements
Description
Duration
Shakehead
Shakeheadfromsidetoside,varyingpaceanddirection
30seconds
Remainstill
Remainseated,avoidingheadmovementsandeyeblinksandmovements
20seconds
Nodhead
Nodheadupanddown,changingpaceasdoingso
30seconds
Remainstill
Remainseated,avoidingheadmovementsandeyeblinksandmovements
20seconds
Rollhead
Rollheadinbothdirections,changingpaceasdoingso
30seconds
Remainstill
Remainseated,avoidingheadmovementsandeyeblinksandmovements
20seconds
Clenchjaw
Prolongedaswellintermittentclenches(mimickingchewing)
30seconds
Remainstill
Remainseated,avoidingheadmovementsandeyeblinksandmovements
20seconds
Raiseandlower
Changingpaceandamplitudethroughout
30seconds
eyebrows
Remainstill
Remainseated,avoidingheadmovementsandeyeblinksandmovements
20seconds
46
Table2.2:Datacharacteristicsforeachpatientrecorduse
dinthedevelopmentofthe
epileptiformactivitydetectionsystem.
Patient
Record

Length(s)
No.Abnor-

malEvents
TotalEventDu-

ration(s)
MeanEventDu-

ration(s)
1
953
2
0.8
0.4
2
1168
1
0.4
0.4
3
2736
5
3.6
0.72
4
3122
2
0.7
0.35
5
1219
13
18.2
1.4
6
1213
4
4.8
1.2
7
1221
14
29.8
2.129
8
1200
1
3.9
3.9
Mean
1604
-
-
1.312
Total
12832
42
62.2
-
2.9.3NeonatalEEG

TheneonatalEEGusedinthisthesisisclinicaldatarecorde
dinNICUsatCorkUniversity
MaternityHospital(CUMH)andUniversityCollegeHospital
sLondon.Thedatasetcan
besplitintotwomaincohorts;EEGdatausedtodeveloptheau
tomatedneonatalseizure
detectionalgorithm(carriedoutbyFaul(2007),Greene(20
07),Thomas(2011)andTemko
etal.(2011b))andEEGdatausedtodevelopandevaluatethea
rtefactremovalalgorithms.
Developmentoftheautomatedseizuredetectionsystem

DatarecordedatCUMHwasusedtodevelop,trainandinitiall
ytesttheautomated
neonatalseizuredetectionalgorithmthatisutilisedinth
isthesis.EEGwasrecorded
from55babieswithhypoxicischemicencephalopathy(HIE)b
etween2003and2006;up
to72hoursofdatawasrecordedperpatient.Withinthegroup
,17patientsunderwent
seizure,withallseizuresthatoccurredovertheinitial72
hourperiodafterbirthcaptured.
Thesepatientswerefull-termneonatesrangingingestatio
nalagefrom39to42weeks.A
NicOnevideoEEGmachinewasusedtorecordmultichannelEEG
at256Hzusingthe
10-20systemofelectrodeplacementmodiedforneonates.I
nthisstudy,8bipolarEEG
channelswereused(F4-C4,F3-C3,T4-C4,C4-CZ,CZ-C3,C3-T
3,C4-O2andC3-O1).
Thedatasetcontainedover267hoursofEEGfromwhichatotal
of705seizureeventswith
ameandurationof3.89minuteswereannotatedbyaneonatale
lectroencephalographer.
Per-channelannotationswerenecessaryforclassiertrai
ning;per-channellabelswere
obtainedfor2minutesofseizuredatafromeachpatient.Add
itionally,2minutesof
artefactfreenon-seizuredatawasannotatedforeachpatie
nt.Usingthisdata,theseizure
detectionsysteminitspresentformwasdevelopedandevalu
atedbyTemkoetal.(2011b)
47
Table2.3:Datacharacteristicsforeachneonatalpatientu
sedinthedevelopmentofthe
neonatalartefactremovalalgorithms.
Patient
Record

length

(hours)
No.of

seizures
Totalseizuredu-

ration(s)
Meanseizuredu-

ration(s)
1
24
20
1510
75.5
2
48
46
2963
64.41
3
24
18
1435
79.72
4
24
40
3571
89.28
Mean
30
31
-
77.23
Total
120
124
9407
-
andThomasetal.(2011).

Datausedinartefactremovaltechniques

DatacollectedatUCLHwasusedtodevelopandtestmethodsof
artefactremovalat
thepre-processingstageoftheseizuredetectionalgorith
mdescribedinthepreviouspara-
graphs.Thisdataconsistedoffourneonatalpatients;deta
ilsofseizureoccurrencesare
displayedinTable2.3.

Eachpatientsueredfromseizurewithin72hoursofbirth,a
ndtheEEGrecordingsofeach
patientcontainedconsiderablerespiratoryartefact.Res
pirationtracesandECGsignals
wererecordedforpatients1and2.Patients3and4didnothav
earespirationtrace
available;ECGsignalswerehowever,recordedforthesepat
ients.Astheperformanceof
theseizuredetectionalgorithmwastheultimatemeasureof
thealgorithmsperformance,
annotationswerenotrequiredfortherespirationartefact
.
2.9.4Performanceassessment

Anumberofmetricsareusedinthisthesistoeectivelymeas
ureandcomparetheperfor-
manceofartefactprocessingalgorithms.Evaluatingthepe
rformanceofsupervisedlearn-
ingalgorithmsisreasonablystraightforward,i.e.thedet
ectionalgorithmsareevaluated
bycomparingtheclassicationoutputofeachepochoftestd
atawiththecorrespond-
ingannotations.Additionalmetricscanthenbeconstructe
dthataimtocapturethe
intricaciesoftheclassicationtaskathand,beitartefac
tdetection(Chapters3,4and
5),epileptiformactivitydetection(Chapter6)orneonata
lseizuredetection(Chapter7).
Thesemetricsarebrieyoutlinedinthissection,withaddi
tionaldetailsincludedinthe
48
relevantchapters.

Detectionmetrics

Epoch-basedmetricsareusedtoevaluateclassierperform
anceacrossarangeofoper-
atingpoints.Eachoftheclassicationtasksdescribedint
histhesis,areformulatedas
binarydecisionproblemsandassuchcanberepresentedinas
tructureknownasacontin-
gencytable.Toillustratethis,considerthebinaryclassi
cationofEEGintotwoclasses:
artefactandnon-artefact.Thiscontingencytablehasfour
categories:truepositives(
TP
)
areepochscorrectlylabelledasartefact;falsepositives
(
FP
)refertoepochsincorrectly
labelledasartefact;truenegatives(
TN
)correspondtocorrectlylabellednon-artefact
epochsandfalsenegatives(
FN
)refertoepochsincorrectlylabelledasnon-artefact.The
accuracyofeachclassisthenevaluatedusing
Sensitivity
and
Specicity
.
Sensitivity
is
denedinequation2.12as:
Sensitivity
=
TP
TP
+
FN
:
(2.12)
Specicity
isdenedinequation2.13as:
Specicity
=
TN
TN
+
FP
:
(2.13)
ReceiverOperatorCharacteristic
(ROC)curvesshowhowsensitivityvarieswithspeci-
city;withtheareaundertheROCcurveshowntobeaneectiv
ewayofcomparing
theperformanceoftwodierentclassiersystems(Fawcett
,2006).Theperformanceof
theartefactdetectionsystemsoutlinedinChapters3,4and
5arecomparedusingROC
curves,andtheareaundertheROCcurve.Inthisthesis,area
sundertheROCcurveare
calculatedusingtrapezoidalintegration.

Intheneurologicaleventdetectionsystemsdescribedinth
isthesis(epileptiformdetection
andneonatalseizuredetection)itisimportanttoevaluate
theclassicationperformance
intheregionoftheROCcurvemostrelevanttotheclassicat
iontask.Thatis,by
incorporatingdomain-specicinformationabouttheneuro
logicaleventaswellhowthe
neurologicaleventdetectionsystemwillbeutilised,allo
wsmoreeectiveevaluationof
systemperformance.Fortheepileptiformdetectionsystem
soutlinedinSection2.8.1,
itisimportanttodetectall(oralmostall)epileptiformev
ents,evenifthismeanslarge
numbersoffalsedetections;asepileptiformeventsarerar
eandoftenshort,missingan
49
epileptiformepochcanmeanmissingtheepileptiformevent
initsentirety.Missingentire
epileptiformeventsisunacceptableinthecontextthatthe
systemwillbeused,namely
screeninglongEEGrecordingsforindicatorsofsusceptibi
litytoepilepsy.Thatis,missing
aneventmeanstheeventwillneverbeseenbytheclinicianre
viewingtheEEG,whereas
falsedetections(withinreason)cansimplybediscardedup
oninspection.Withthisin
mind,itisclearthattheareaoftheROCcurvewheresensitiv
ityishighisprimarily
ofinterest.Anadditionalmetric,
ROC
sens
95
,isthususedtomeasuretheclassication
performanceofeachepileptiformactivitydetectionclass
ier.
ROC
sens
95
representsthe
areaundertheROCcurveaboveasensitivityof95%,wherea
ROC
sens
95
of100%
referstoperfectdiscriminationinthisregionoftheROCcu
rve.InFigure2.15itcanbe
seenthatarandomdiscriminationishighlightedbythedott
edredline,andisequivalent
toa
ROC
sens
95
of2
:
5%.AswasthecasefortheROCareasreportedinthisthesis,t
he
ROC
sens
95
areawascalculatedusingtrapezoidalnumericalintegrati
on.



Figure2.15:IllustrationofROC
sens
95
andROC
spec
90
.TheROCcurveisplottedinblue.
Thehorizontal,dashedlinerepresentsthelowerboundofth
eROC
sens
95
areausedin
theepileptiformactivitydetectionalgorithm.Thevertic
algreenlinerepresentsthelower
boundoftheROC
spec
90
area,usedinevaluatingtheneonatalseizuredetectionalg
orithm.
Thedottedredlinerepresentsrandomdiscriminationinthe
classicationtask.
IntheneonatalseizuredetectionsystemsdescribedinSect
ion2.8.3,thenecessitytodetect
allseizureepochscanberelaxedsoastofacilitateareduct
ioninfalsedetections.False
detectionsmayhaveclinicaldecisions(e.g.prescription
ofanti-epilepticdrug)resting
heavilyuponthemandsomustbekepttoanabsoluteminimum.A
dditionally,asseizures
typicallylastlongerthanasingleepoch,ifoneepochinase
izureismissed,theseizurecan
stillbedetectedbytheclassier.Theneonatalseizuredet
ectionsystemwillthusoperate
inregionsoftheROCcurvewherespecicitiesarehigh;anad
ditionalmetric,
ROC
spec
90
,
50
isthusused.
ROC
spec
90
isdenedastheareaundertheROCcurve,abovethespecicit
y
of90%,asillustratedinFigure2.15.

Inadditiontotheepoch-basedmetricsoutlinedabove,ther
eareanumberof
event-based
metricsusedinevaluatingtheneurologicaleventdetectio
nclassiersinthisthesis.
Good
DetectionRate(GDR)
,isthepercentageofneurologicalevents(epileptiformac
tivityor
neonatalseizure)withinwhichatleastoneepochiscorrect
lyclassiedasrepresentingthe
neurologicalactivityinquestion,anddenedinequation2
.14as:
GDR
=
TP
events
TP
events
+
FN
events
:
(2.14)
FalseDetectionsperhour(FD/h)
,anotherevent-basedmetric,isusedtoassessthefalse
detectionsoftheclassier;FD/hisdenedasthenumberofp
redictedseizureeventsin
1hourthathavenooverlapwithactualreferenceseizures(T
emkoetal.,2011c).Anal
epoch-basedmetric,
Falsedetectionrate(FDR)
isalsousedinthisthesisforevaluating
theperformanceoftheepileptiformactivitydetectionalg
orithminChapter6.However,
asthereasonsforusingthismetricarecloselylinkedtothe
detailsoftheclassierdetails,
amorethoroughdescriptionofFDRisdiscussedinChapter6.

Artefactremovalmetrics

Artefactremovalalgorithmshavetwoprimary,andoftenove
rlappinggoals;toremove
artefactsfromtheEEGwhileleavingthecerebralportionof
theEEGintact,soasto(i)
improvetheperformanceofaneurologicaleventdetectiona
lgorithmand/or(ii)\clean"
theEEGforeaseofinterpretationbyaclinician.Accuratel
yevaluatingtheperformanceof
artefactremovalalgorithmspresentsalessstraightforwa
rdchallengethanthatofevaluat-
ingdetectionalgorithms.Thatistosay,quantifyingtheex
tentofartefactsremoved,and
thecorrespondingdegreeofpreservingthecerebralportio
noftheEEG,isdicultwith-
outpriorknowledgeastowhata\cleaned"EEGsignalshouldl
ooklike.Conversely,the
performanceofartefactremovalalgorithmsthatusesimula
tedEEGcanbeeasilyquan-
tied,astheoriginal,cleanEEGisarticiallymixedwithc
orruptingartefacts.Thus,
metricsthatquantifythelikenessoftheoriginal,cleanEE
Gwiththeartefact-processed,
\cleaned"EEGcanbeused.Thesemetricsincludethecorrelat
ion,mean-squareerror
andsignal-to-noiseratioamongstothers.Itispresumedth
atthisisaprimaryreason
thatmanyartefactremovalpublicationsareevaluatedonsi
mulateddata.However,while
thesemetricsarenumericallyprecise,thisprecisiondoes
notnecessarilypertaindirectly
51
toreal-worldartefactremoval.Thedatarecordingmethod,
thedataselectionprocess,
andwhetherthebackgroundandartefactEEGwasrealormodel
led(asinmanypubli-
cations)allintroduceconsiderablebiasesintotheexperi
ment.Themethodinwhichthe
backgroundandartefactEEGaremixedalsointroducesigni
cantbiasesintotheexperi-
ment,mostnotablywhenevaluatingtheperformanceofblind
signalseparationtechniques
whichinturnarepredicateduponassumptionsaboutthenatu
reofmixingoftheunder-
lyingsources.Theseargumentscoupledwiththoseoutlined
inSection2.9.1explainwhy
simulatedartefactdatawasnotusedinthisthesis.

Toguidethechoiceofevaluationmetric,itisperhapsworth
re-statingthattheprimary
researchgoalinthisthesisistodevelopartefactprocessi
ngtechniquesthatimprovethe
performanceofstate-of-the-artautomatedEEGmedicaldia
gnosticsystems.Theprincipal
measureofartefactremovalperformanceisthuswhetherorn
ottheunderlyingneurological
eventdetectionsystemimprovesornot.Therefore,itisthi
smeasure(andtheclassication
metricsassociatedwithit)thatisusedtoevaluatetheperf
ormanceofrespirationartefact
removalforneonatalEEG(Chapter7).

2.10Summary

Thischapteroutlinedindetailthepervasiveissueofartef
actcontaminationinEEGrecord-
ings.Theseartefactsinterferewithvisualinspectionoft
heEEGandoftensignicantly
hindertheperformanceofautomatedneurologicaleventdet
ectionsystems.Thesheer
volumeofpaperspublishedthatproposemethodsaimedatall
eviatingthisproblemgives
anindicationofthenecessityforautomatedsystemstodete
ctandremovetheseartefacts.
Acomprehensivereviewofthemeritsandfailingsoftheseal
gorithms,however,showed
thatitisalsoclearthatdespitetheeortsmade,currentst
ate-of-the-artinautomated
artefactdetectionandremovalisnotsucient.

WithEEGconsideredthegoldstandardformanyapplications
wherespatio-temporalin-
formationregardingthefunctioningofthebrainisrequire
d,itisapparentthatautomated
neurologicaleventdetectionsystemsaredesirable.Twosu
chareasinthemedicaldomain
aretheeldsofepilepsyandneonatalseizurediagnosis.Th
ischapterreviewedcurrent
methodsforautomatedneurologicaleventdetectionsystem
sinepilepsyandneonatal
seizurediagnosis;itisevidentfromthisliteraturerevie
wthatthesesystemshaveyet
toattaintherequisiteperformancenecessaryforwidespre
adclinicaldeployment.EEG
52
artefactshavebeenwidelyreportedasaleadingobstaclein
theachievementofthisgoal.
Accordingly,thischapteroutlinedaframeworkforthebiom
edicalsignalprocessingand
machinelearningmethodsthatareusedinthisworktofurthe
rartefactdetectionand
removalprocessing.Thefollowingchapterswilldetailnov
elmethodsthatweredeveloped
inthisthesistodetectandremovetheseproblematicartefa
cts.Thisworkwillfollowthree
broadthreads:(i)detectionofhead-movementartefactsin
ambulatoryEEG,(ii)artefact
detectionandfusioninaclinical,epileptiformactivityd
etectionsystemand(iii)artefact
removalinastate-of-the-art,neonatalseizuredetection
system.
53
Chapter3

Detectingartefactsarisingfrom

head-movements

3.1Introduction

WhentheheadmovesduringanEEGrecording,awiderangeofel
ectricalsignalsarising
fromsourcesexternaltothebrainmaycontaminatetheEEGsi
gnal.Contamination
typicallytakestheformofsomecombinationofEMG,ocular,
electrodepopandelectrode
movementartefacts,andobscurestheEEGtrace,makingitdi
culttointerpretthe
signalbytheresearcherorclinician,especiallyforinexp
eriencedreaders.Inautomated
neurologicaleventdetectionsystemssuchasepilepsydete
ctionorbraincomputerinterface
applications,artefactsintroducedbyhead-movementsfre
quentlyleadtomisclassication
bythepatternrecognitionsystem.Thisproblembecomesmor
epronouncedinambulatory
environmentswherethemovementsofthepatientoruserareu
nrestrictedandwhere
head-movementsaremorefrequent.Todate,ambulatoryEEGh
asreceivedlittleorno
attentionintheliterature,excepttopointouttheproblem
ofartefactandtheusefulness
ofambulatorymonitoring(Waterhouse,2003).Inthischapt
er,thefeasibilityofaccurately
detectingthesehead-movementartefactsusingstatistica
lpatternrecognitiontechniques
isinvestigated.

Ajournalpaper(O'Reganetal.,2013a)andapeer-reviewedi
nternationalconference
publication(O'Reganetal.,2010a)havearisenfromthewor
kcarriedoutinthischapter.
54
3.2Theproblemofhead-movementartefactsinambulatory
EEG
Artefactsarisingfromhead-movementsoftenprovetrouble
somebothforEEGinterpreta-
tionbyaclinician,andalsointhedeploymentofautomaticn
eurologicaleventdetection
systems,suchasepilepticseizuredetectionorbrain-stat
eclassication.Byobscuringthe
EEGduringepilepticseizures,artefactscaninterferewit
htheclinicians'interpretationof
therecordedseizures,oftenmakingitdiculttoidentifya
ndlocalisetheictalonsetand
oset(DelormeandMakeig,2004).Inautomaticseizuredete
ction,thepresenceofarte-
factsmayleadtofalselyinterpretingasectionofartefact
EEGasseizure.Inmanyclinical
EEGtrials,contaminationbyartefactsisminimizedbycont
rollingthetestsituationto
limitmovement.Inanambulatorysettingthisisunrealisti
casbydenitionambulatory
referstoanenvironmentwherethepatientcanwalkandmovea
bout.Similarly,incases
suchasdiagnosingepilepsy,restrictingmovementsmayeve
nbeundesirableasitmayex-
cludethepresentationofeventsthatoccurduringeveryday
lifeandthattriggerepileptic
seizureinthepatient.

3.2.1Generalisedhead-movementartefactdetection:isit
possible?
Headmovementscanintroduceawiderangeofnon-cerebralel
ectricalactivityintothe
EEG.Typicallythesemovementsresultincontaminationint
heformofsomecombination
ofmuscle(EMG),electrodepop,electrodemovementandocul
arartefacts.Asdiscussed
inChapter2,thesecomponentartefactsignalsdisplayawid
erangeofcharacteristics.
Muscleartefactsarepredominantlyhighfrequencysignals
,andcanrangefromlowto
highamplitude(vandeVeldeetal.,1999;Goncharovaetal.,
2003).Electrodepopis
typicallyaccompaniedbyfast,highamplitudespikes(Barl
ow,1986).Electrodemovement
mostcommonlyresultsinslow-wavebaselinedrifts,butcan
sometimesresultinapparent
oscillationintheEEG.Ocularartefacts,introduceddueto
relativemovementbetween
theeyeandtheelectrode,usuallyresultinhighamplituded
eectionsintheEEG(Berg
andScherg,1991;CroftandBarry,2000;Gasseretal.,1992)
.
Whilethesecomponentartefactsignalsexhibitdiversetem
poral,frequencyandstructural
characteristics,theyaresignicantlydierentfromthos
eofnormalEEGactivity.Itis
thusproposedthatthecomponentartefactsignals(EMG,ele
ctrodepop,movementand
ocularartefacts)begroupedtogetherindistinguishingth
emfromnormalEEGactivity.To
55
Figure3.1:Real-timeEEGAnalysisforEventDetection(REA
CT)prototypedevice.
theauthor'sknowledge,theworkpresentedhereistherstt
otreatambulatoryEEGfor
artefactsarisingfromheadmovementasasingleclassinana
utomaticartefactdetection
algorithmandassuchisanovelapproachtotheartefactdete
ctionproblem.
3.2.2AmbulatoryREACTsystem

AmbulatoryREACT(
R
eal-time
E
EG
A
nalysisforEventDete
CT
ion)isasmallform
factorsystemdevelopedbytheEcientEmbeddedDigitalSig
nalProcessing(EEDSP)
groupatU.C.C.thatperformsreal-timeEEGmonitoringusin
gaDSPmicroprocessor.
Thispoint-of-caretechnologyisdesignedforunobtrusive
wardanddomesticdetectionof
neurologicaleventsinadults,wherebythepatientswearth
edeviceandgoabouttheir
dailylivesasusual(Temkoetal.,2010;McEvoyetal.,2010)
.Thesystemisbuiltaround
theconceptofintelligence-at-the-sensor;wherebytheco
stlyrequirementofcontinuously
transmittingrawbio-signaldataisremoved,andonlydatao
frelevance(suchasseizure
alarms)aretransmitted.ApictureoftheREACTprototypeis
showninFigure3.1.
REACTisbasedonaSupportVectorMachine(SVM)classier,a
ndusesinformationfrom
56











Figure3.2:Real-timeEEGAnalysisforEventDetection.Thi
sarchitectureshowsthree
potentialmethodsofincorporatingartefactdetectionint
othesystem.(a)indicatesrejec-
tionofepochsclassiedasartefact.(b)indicatesclassi
erfusionofseizureandartefact
information.(c)representsartefactannotation,perform
edseparatelyfromtheseizure
classicationtask.
57
arichsetoffeaturestoclassifyEEGepochsaseitherseizur
eornon-seizure.Thesystem
hasbeenshowntoachievestate-of-the-artperformanceond
atasetsofadultEEG(Faul
etal.,2009;Temkoetal.,2010,2011b);therebyrapidlyass
istingneurophysiologistsin
identifyingareasofinterestinEEGrecordings.

Theworkoutlinedinthischapterpresentstherststagesin
thedevelopmentofanarte-
factdetectionsystemtobeimplementedwithambulatoryREA
CT.Discussionswithclin-
iciansatCorkUniversityHospitalaswellasreportsinthel
iteraturehaveidentiedhead
movementartefactsascausingdicultybothintermsoffals
epositiveseizureclassica-
tionandalsoinobscuringtherecordedEEGforsubsequentme
dicalexaminationBarlow
(1984,1986).AsoutlinedinChapter2,identifyingsection
sofEEGthatarecontami-
natedbyartefactwouldbeusefulforvariousapplications.
Includingartefactdetectionin
ambulatoryREACTcouldtakeanumberofguises;Figure3.2il
lustrateshowthreesuch
methodscouldbeincorporatedintoREACT.Artefactdetecti
oncouldtaketheformof
detectingepochsthatcontainhead-movementartefactandr
ejectingtheseepochssothat
theseizuredetectionclassierispresentedwithnon-arte
factualEEGalone.Alternatively,
informationfromtheseizuredetectionandartefactdetect
ionclassierscouldbecombined
atthepost-processingstage.Finally,artefactdetection
couldbeincludedasanannotation
toolfortheclinicianwherebyhe/sheusesinformationfrom
theartefactdetectionclassier
whenexaminingtheEEGrecording.

3.2.3Artefactdetectionusingsupervisedmachinelearnin
g
Artefactdetectionusingsupervisedmachinelearningwill
takethefollowinggeneralframe-
work.RawEEGsignalswillbepreprocessedsoastoremove50H
zmainsfrequencyarte-
factandlow-amplitudeDC-componentofthesignal.Thesest
epswillbeaccomplished
withniteimpulseresponse(FIR)lters.Eachchannelofth
eEEGsignalisthenseg-
mentedintooverlappingwindowsorepochs;asetofrelevant
featuresissubsequently
extractedfromeachoftheseepochs.Thesefeaturesandthel
abels(i.e.annotations)asso-
ciatedwiththemareusedtotrainamachinelearningclassi
ertoobtainadiscriminating
boundarybetweenthetwoclasses(artefactandnormalEEG)t
hatisoptimalinsome
sense(Abu-Mostafaetal.,2012).Thatistosay,themachine
learningalgorithmdenes
acostfunctiontorepresenttheseparabilityoftheclasses
andperformsanoptimisation
ofthecostfunctionusingthetrainingdata.Thefollowings
ectionsprovidedetailsonhow
thisframeworkwasappliedtotheartefactdetectiontaskus
ingasetof69EEGfeatures,
58
andlineardiscriminantandsupportvectormachinesclassi
cationmodels.
3.3EEGfeatures

FeaturesarequantitativedescriptorsoftheEEG,whosepur
poseistoshowsignicant
changesinvaluebetweenclasses;inthisapplication,tosh
owchangesinvalueduring
thepresenceofartefactsarisingfromhead-movementascom
paredtobackgroundEEG
activity.Thesefeaturesarechosentotakeadvantageofdi
erencesintheunderlying
characteristicsofbackgroundandartefactEEG.

Inordertocalculatefeatures,theEEGsignalissegmentedi
ntowindows/epochswhose
durationiscapableofcapturingthecharacteristicsofthe
eventtobedetected.Head-
movementartefactsarecomprisedofunderlyingartefactso
fdieringlengths;inthegener-
alisedhead-movementdetectiontask,itnotclearwhatwind
owlengthismostappropriate.
Therefore,inthischapteranumberofdierentwindowlengt
hsareinvestigatedandthe
corresponding,overallsystemperformanceissubsequentl
yevaluated.Thesegmentation
processincludedoverlapof90%wasusedsoastoincreasethe
amountofdataavailable
andhasbeendemonstratedintheliteraturetobeappropriat
e).
WhileEEGeventscanhavedierentshapes,morphologiesand
timings,therearelarge
similaritiesandcommoncharacteristicsbetweenEEGevent
srepresentingvastlydierent
neurologicalphenomena(orinthecaseofartefact,non-neu
rologicalevents).Consequently,
thereissignicantcross-fertilisationoffeaturesbetwe
envariousautomatedEEGappli-
cationsandevenbetweendierenttime-series,machinelea
rningapplicationsingeneral
(perhapsmostnotably,fromspeechprocessingtoEEG).Feat
uresetsusedinEEGap-
plications,rangingfromseizuredetectiontoimaginedarm
movement(asusedinBCI)
andfromsleepcycleclassicationtoParkinson'sdetectio
n,tendtobebroadlysimilaror
atleastcontainsignicantoverlap.Thisisnottosaythatt
heeventsthemselvesarethe
sameorinsomecasesevensimilar,simplythatsimilarfeatu
res(orgroupsoffeatures)
canbeusedtodierentiatebetweenabroadrangeofdissimil
arevents.Takingthisinto
accountthen,thefeaturesetusedintheartefactdetection
taskisdrawnprimarilyfrom
twosources;theREACTandANSeRneurologicaleventdetecti
onsystemsandseveral
EMGandocularartefactdetectionpapersintheliterature(
vandeVeldeetal.,1999;
Gasseretal.,2005).

Thefullsetof69featuresextractedfromtheEEGislistedin
Table3.1withdetailed
59
Table3.1:ListofEEGfeaturesforhead-movementartefactd
etection.
TimeDomainFeatures

Linelength/CurveLength(L)

RMSAmplitude

Slope

Activity(1stHjorthParameter)

Mobility(2ndHjorthParameter)

Complexity(3rdHjorthParameter)

Kurtosis

Skewness

NonlinearEnergy(N)

ZeroCrossings(Zc)

MinimaandMaxima

AutoregressiveModellingError(ARmodels1-9)

Varianceofrstderivative

Varianceofsecondderivative

ZeroCrossingsofrstderivative

ZeroCrossingsofsecondderivative
FrequencyDomainFeatures

PeakFrequency

SpectralEdgeFrequency(80,90and95)

IntensityWeightedMeanFrequency(IWMF)

IntensityWeightedBandwidth(IWBW)

TotalPower

PowerBands:0-2Hz,1-3Hz,2-4Hz,3-5Hz,4-6Hz,
5-7Hz,6-8Hz,7-9Hz,8-10Hz,9-11Hz,10-12Hz,3-15Hz,
15-30Hz,59-61Hz,51-64Hz,20-30Hz,25-64Hz

NormalisedPowerBands:0-2Hz,1-3Hz,2-4Hz,3-5Hz,4-6Hz,
5-7Hz,6-8Hz,7-9Hz,8-10Hz,9-11Hz,10-12Hz,3-15
Hz,15-30Hz,59-61Hz,51-64Hz,20-30Hz,25-64Hz
Entropy-basedFeatures

SVDEntropy

ShannonEntropy

FisherEntropy

SpectralEntropy
explanationinSections3.3.1,3.3.2and3.3.3.Manyfeatur
esdescribethemorphologyof
theEEGinthetimedomain,withnotabledierencesexisting
betweenthetwoclasses.The
majorityoffeaturesareextractedfromthefrequencydomai
n,wheresignicantdierences
existbetweenbackgroundEEGandartefact.Afurthersetoff
eaturesthatquantifythe
underlyingstructureoftheEEGsignalusingentropy-based
measuresfrominformation
theoryarealsoinvestigated.

3.3.1Timedomainfeatures

WhenaclinicianorresearcherexaminesanEEGrecording,it
istimedomainfeaturesthat
areobserved.Thesetimedomainfeaturestypicallyencompa
sstheshapeandmorphology
60
ofthesignalandcanincludepoorly-deneddescriptionsof
thewaveform(suchasspikiness,
uniformityordegreeofasymmetry).Forautomatedartefact
detection,thesequalitative
characteristicsmustbetranslatedintoaquantiablenume
ricalmeasure.Anumberof
featuresareextractedfromthetimedomainEEGsignaltocap
turethecharacteristics
thatahumanEEGreaderwouldusetoidentifyartefact.These
featuresarecomplimented
byadditionaltimedomainfeatures(suchastimedomainmode
lsoftheEEGsignal)that
maynotbeapparenttothehumanobserver,butneverthelessp
rovideusefulseparation
betweennormalEEGandartefacts.Thesefeaturesarederive
dfromastatisticalanalysis
oftheEEGsignalwithinanepoch(orfromtherstandsecondd
erivativesoftheEEG
signalwithinanepoch).

Linelength/Curvelength

Linelength(L)isusedasameasureofsignalcomplexity,ini
tiallyproposedbyEsteller
etal.(2001)asanindicatorofseizureonset.Itissimilart
othewaveformfractaldimension
althoughithasbeenshowntobemorecomputationallyecien
t.Linelength(sometimes
referredtoascurvelength)isdenedforanepoch
x
j
as:
L
(
x
j
)=
n
s
X
i
=0
j
x
j
(
i
+1)

x
j
(
i
)
j
:
(3.1)
Thus,linelengthistherunningsumofdistancesbetweencon
secutivepointswithinthe
slidingwindowofsize
n
s
.Thediscriminatingpotentialofafeaturecanbevisualise
dby
meansofaprobabilitydensityfunction(pdf),whichplotst
herelativelikelihoodthatthe
featurewilltakeonagivenvalue.Thus,afeatureisdiscrim
inativeinnon-overlapping
areasofthepdfs.Figure3.3displaysprobabilitydensityf
unctionsforthelinelengthof
backgroundEEG(blue)andhead-movementartefactEEG(gree
n),whereitcanbeseen
thatthehead-movementartefacthasamuchbroaderdistribu
tionthanthatofbackground
EEG.Thisistobeexpectedasthehead-movementartefactisc
omprisedofanumberof
contributoryartefactsources(namely,muscle,ocular,el
ectrodepopandelectrodemove-
mentartefacts).Atlowerlinelengthsthecontributionofm
uscleandocularartefactsis
seen,whereashighamplitudeelectrodepopexplainsthebro
adtailofthedistributionat
higherlinelengths.Inthisthesis,probabilitydensityfu
nctionsweregeneratedusinga
randomsampleof5000datapointsperclass.
61
05001000150020002500300000.511.522.5x 10-3Line Length (L)Occurrence  Reference EEGArtefactFigure3.3:Probabilitydensityfunctionforlinelength(L
)ofbackgroundEEG(blue)and
head-movementartefact(green).

Rootmeansquareamplitude

Therootmeansquare(RMS)amplitude,orquadraticmean,isa
statisticalmeasureof
themagnitudeofatimevaryingquantity.TheRMSamplitudee
xpressesthemeanofthe
absoluteamplitudeofanepoch
x
j
andisdenedas:
RMS
(
x
j
)=
v

u

u

t
1
n
s
n
s
X
i
=1
x
2

j
(
i
)
:
(3.2)
AsartefactEEGisoftenhigh-energy,high-amplitudesigna
ls,theRMSamplitudeaims
tocapturethistrait.ThisishighlightedinthepdfsinFigu
re3.4,wheretheartefact
EEGisdistributedfarthertotherightthanthatofthebackg
roundEEG.Oncemore,as
theartefactclasscomprisesanumberofdierentsignaltyp
esthefeaturevaluesaremore
broadlydistributedthanthatofthebackgroundEEG.

Slope

TheslopeoftheEEGsignaldescribesitssteepnessandiscal
culatedbytherstderivative
d
x
j
(
i
)ofthesignal,where
d
x
j
(
i
)=
x
j
(
i
)

x
j
(
i

1).Themeanslopeofeachepochis
givenbythecumulativesumoverconsecutivesamplepoints:

EEG
=
1
N

1
N
X
i
=2
d
x
j
(
i
)
:
(3.3)
62
05101500.010.020.030.040.050.060.070.08RMS amplitudeOccurrence  Reference EEGArtefactFigure3.4:ProbabilitydensityfunctionforRMSamplitude
ofbackgroundEEG(blue)
andhead-movementartefact(green).

VarianceandHjorthparameters

Inprobabilitytheoryandstatisticsthevarianceofasigna
l
˙
2
j
isameasureofhowfarthe
numbersinaprobabilitydistributionliefromthemeanofth
atdistribution.Varianceis
oftenreferredtoasthesecondcentralmomentandinEEGsign
alprocessingissometimes
denotedasactivityorthe1stHjorthParameter(Hjorth,197
0).Varianceoractivityis
thusgivenby:
Activity
(
x
j
)=
˙
2
j
=
1
n
s
n
s
X
i
=1
(
x
j
(
i
)


j
(
x
j
))
2
;
(3.4)
where

j
(
x
j
)isthesamplemeanofanepoch
x
j
anddenedas:

j
=

(
x
j
)=
1
n
s
n
s
X
i
=1
x
j
(
i
)
:
(3.5)
Owingtothefactthatartefactsarisefromanumberofdiere
ntsourcesignals,itis
anticipatedthatthevarianceofartefactualsectionsofEE
Gshouldonaveragebegreater
thanthevarianceofnormalEEG.ThisisillustratedinFigur
e3.5,whereitcanbeseen
thatthevarianceofartefactEEGismorebroadlydistribute
dthanthatoftheEEG,with
athicktaildepictingmoreepochswithhighervariances.Th
esquarerootofthevariance
˙
2
j
isreferredtoasthestandarddeviation
˙
j
.Hjorth(1970)alsointroducedtwofurther
EEGfeatures,mobilityandcomplexity,basedonthestandar
ddeviationoftherstand
secondderivativesoftheEEGsignal,respectively.TheHjo
rthmobilityofanepochis
denedas:
Mobility
(
x
j
)=
˙

j
=˙
j
;
(3.6)
63
100200300400500600700800900100000.010.020.030.040.050.06Activity/ VarianceOccurrence  Reference EEGArtefactFigure3.5:Probabilitydensityfunctionforactivityorva
rianceofbackgroundEEG(blue)
andhead-movementartefact(green).
0.20.40.60.811.200.0050.010.0150.020.0250.030.0350.040.0450.05MobilityOccurrence  Reference EEGArtefactFigure3.6:Probabilitydensityfunctionforthemobilityo
fbackgroundEEG(blue)and
head-movementartefact(green).

where
˙

j
isthestandarddeviationoftherstderivativeofanepoch.
Thepdfsforthe
mobilityofeachclassaredisplayedinFigure3.6.Aswithth
eotherfeatures,theartefact
EEGdistributionhasalongtail,withasinglebroadpeak.

Thecomplexityofanepochisdenedas:
Complexity
(
x
j
)=
˙
2
j
=˙

j
˙

j
=˙
j
;
(3.7)
where
˙
2
j
isthestandarddeviationofthesecondderivativeoftheepo
ch.
64
10203040506070809010000.010.020.030.040.050.060.070.080.090.1VarianceOccurrence  Reference EEGArtefactFigure3.7:Probabilitydensityfunctionforthevarianceo
fthe1
st
derivativeofbackground
EEG(blue)andhead-movementartefact(green).
05010015020025000.010.020.030.040.050.060.070.08VarianceOccurrence  Reference EEGArtefactFigure3.8:Probabilitydensityfunctionforthevarianceo
fthe2
nd
derivativeofbackground
EEG(blue)andhead-movementartefact(green).

Varianceofrstandsecondderivatives

Thevarianceoftherst(
˙

j
)andsecond(
˙
2
j
)derivativeswereusedbyThomasetal.
(2010)forneonatalseizuredetection.Theyareincludedhe
reasfeaturesintheartefact
classicationtask.Probabilitydensityfunctionsforthe
varianceofthe1
st
and2
nd
deriva-
tivesaredisplayedinFigures3.7and3.8.Asforthevarianc
e,theartefactEEGismore
broadlydistributedthanthatofthebackgroundEEG,withlo
ngtailsathighervalues.
65
Skewness

Inprobabilitytheoryandstatistics,skewnessisameasure
oftheasymmetryoftheprob-
abilitydistributionofareal-valuedrandomvariable.Ane
gativeskewindicatesthatthe
tailontheleftsideoftheprobabilitydensityfunction(pd
f)islongerthanthatoftheright
side,withthebulkofthevalueslyingtotherightofthemean
.Conversely,apositive
skewindicatesthatthetailontherightsideislongerthant
hatoftheleftandthebulk
ofthevalueslietotheleftofthemean.Zeroskewnessindica
testhatthevaluesarerela-
tivelyevenlydistributedeithersideofthemean,typicall
y(butnotnecessarily)implying
asymmetricdistribution.Skewnessisoftenreferredtoast
hethirdcentralmomentand
isdenedas:
Skewness
(
x
j
)=
1
n
s
P
n
s
i
=1
(
x
j
(
i
)


j
)
3
(
1
n
s
P
n
s
i
=1
(
x
j
(
i
)


j
)
2
)
3
=
2
:
(3.8)
Aprobabilitydensityfunctionisnotdisplayedhereforske
wnessasthefeaturedidnot
exhibitsignicantdiscriminationonitsown.

Kurtosis

Kurtosis,oftenreferredtoasthefourthcentralmoment,is
ameasureofthe\peakedness"
ofaprobabilitydensityfunctionandisdenedasfollows:
Kurtosis
(
x
j
)=
1
n
s
P
n
s
i
=1
(
x
j
(
i
)


j
)
4
(
1
n
s
P
n
s
i
=1
(
x
j
(
i
)


j
)
2
)
2
:
(3.9)
Ahighkurtosisdistributionhasasharppeakandlong,fatta
ils,whilealowkurtosis
distributionhasamoreroundedpeakandshort,thintails.U
nlikemanyoftheotherdis-
playedfeatures,thepdfsofnormalandartefactEEGoverlap
signicantlyforthisfeature,
asseeninFigure3.9.However,aswillbediscussedinSectio
n3.4ifthemarginalclass
distributionsareoverlappingthisdoesnotnecessarilyim
plythatthefeaturecannotpro-
videusefuldiscriminationwhencombinedwithadditionalf
eaturesinahigherdimensional
space.
66
1.522.533.544.555.5600.020.040.060.080.10.120.14KurtosisOccurrence  Reference EEGArtefactFigure3.9:Probabilitydensityfunctionforthekurtosiso
fbackgroundEEG(blue)and
head-movementartefact(green).

Nonlinearenergy(NLE)

Non-linearenergy(NLE)isafunctionoftheamplitudeofasi
gnal,andthechangeofthat
amplitudeandisdenedas:
NLE
(
x
j
)=
1
n
s

2
n
s

1
X
i
=2
x
j
(
i
)
2

x
j
(
i

1)
x
j
(
i
+1)
:
(3.10)
NLEwasintroducedbyD'Alessandroetal.(2003)asafeature
inanepilepticseizure
predictionalgorithm.Greeneetal.(2008),Thomasetal.(2
010)andTemkoetal.
(2011b)havefoundNLEtobeusefulinneonatalseizuredetec
tionalso.ThepdfsofNLE
aredisplayedinFigure3.10whereitcanbeseenthatthearte
factEEGismoreuniformly
distributedthanthebackgroundEEG,wherelowNLEvaluesar
emostcommon.
Numberofzerocrossings(Zc)anditsderivatives

Thenumberofzerocrossings(Zc)isthenumberoftimeswithi
nanepochthattheEEG
signalcrossesthex-axis.Thenumberofzerocrossingsofth
e1stderivativeoftheEEG
correspondstothenumberoflocalmaximaandminimaoftheEE
G.Thenumberofzero
crossingsof2ndderivativecorrespondstothenumberoftim
esthatthe2ndderivativeof
theEEGsignalcrossesthex-axiswithinanepoch.InFigures
3.11and3.12,itcanbe
seenthatthepdfsofnormalandartefactEEGforthenumberof
zerocrossingsofthe1
st
and2
nd
derivativesoverlapconsiderably.However,aswillbeseen
inSections3.4and3.5,
67
10020030040050060070080090000.010.020.030.040.050.060.07Non-linear EnergyOccurrence  Reference EEGArtefactFigure3.10:Probabilitydensityfunctionforthenon-line
arenergyofbackgroundEEG
(blue)andhead-movementartefact(green).
1020304050607000.020.040.060.080.10.120.140.160.18Number of zero crossings Occurrence  Reference EEGArtefactFigure3.11:Probabilitydensityfunctionforthenumberof
zerocrossingsofthe1
st
derivativeofbackgroundEEG(blue)andhead-movementarte
fact(green).
whencombinedwithotherfeatures,thesefeaturesdoimprov
eclassicationperformance
intheartefactdetectiontask.

Numberofinactivesamples

Thenumberofinactivesampleswithinanepoch
x
j
isdenedasthenumberofsamplesfor
whichthereisverylittlechangeintheEEGamplitude.Thisw
ascalculatedbyapplying
athresholdof0.01totheabsolutevalueofthederivativeof
theEEGsignal.
68
4550556065707500.050.10.150.20.25Number of zero crossingsOccurrence  Reference EEGArtefactFigure3.12:Probabilitydensityfunctionforthenumberof
zerocrossingsofthe2
nd
derivativeofbackgroundEEG(blue)andhead-movementarte
fact(green).
Autoregressivemodellingerror

Anautoregressive(AR)modelcanbeusedforpredictioninac
orrelatedtimeseries.A
variable^
x
(
k
)inacorrelatedtimeseriescanbepredictedfrompreviouso
bservationsin
theseriesby:
^
x
j
(
k
)=
n
p
X
i
=1
˚
j
(
i
)^
x
j
(
k

i
)+

k
;
(3.11)
where
˚
j
(
i
)arethe
n
p
parametersoftheARmodeland

k
isazeromean,whitenoiseterm
accountingfortheerrorineachpredictionstep.The
˚
j
(
i
)parametersoftheARmodel
areestimatedoverthersthalfoftheepoch
x
j
.TheARmodelisttothedataoverthe
rsthalfoftheepochusingtheYule-Walkermethod(Kay,198
8)andthemodelisusedto
performonestepaheadpredictiononthesecondhalfoftheep
och.Thepercentageerror
isthengivenby:
AR
fit
(
x
j
)=100

1

P
n
s
k
=
n
s
2
+1
j
x
j
(
k
)

^
x
j
(
k
)
j
P
n
s
k
=
n
s
2
+1
j
x
j
(
k
)

x
j
j

;
(3.12)
where:
x
j
=
1
n
s
=
2
n
s
X
k
=
n
s
2
+1
x
j
(
k
)
:
(3.13)
Atotalof9featuresaregeneratedusingthisapproach,corr
espondingtomodelsoforders
1to9.Figure3.13illustratespdfsfortheautoregressivem
odeltfor1
st
orderARmodel.
69
010203040506070809010000.0050.010.0150.020.0250.03Model fitOccurrence  Reference EEGArtefactFigure3.13:Probabilitydensityfunctionfortheautoregr
essivemodelt(1
st
order)of
backgroundEEG(blue)andhead-movementartefact(green).

3.3.2Frequencydomainfeatures

WhenaclinicianorresearcherexaminesanEEGtrace,theyex
plicitly(viaafastFourier
transform(FFT)computedinthevisualisationsoftware)or
implicitly(byobservingthe
periodicityofeventsintheEEGsignal),utiliseinformati
onfromthefrequencydomain.
Consequently,featuresfromtheEEG'sfrequencydomainare
usedtoquantifychanges
inthespectrumoftheEEGduringthepresenceofartefact.Th
epowerspectraldensity
(PSD)ofanepochisobtainedusinga128pointFFT.TheFFTgiv
esanoutputof
n
s
complexcoecients,whichareconvertedtorealvaluesbyta
kingtheabsolutevalueof
thecoecients.ThespectrumofanEEGepoch
x
j
canbeexpressedinvectorformas
frequencycoecients
a
j
=[
a
j
(0)
;a
j
(1)
;:::;a
j
(
i
)
;:::;a
j
(
n
s
2
)]where
a
j
(
i
)istheamplitude
ofasinusoidoffrequency
i
f
s
n
s
.
Thefollowingfrequencydomainfeaturesarethenderivedfr
omthePSDofeachepoch:
Peakfrequency

Peakfrequencyisdenedasthefrequencycorrespondingtot
helargestamplitudeinthe
powerspectraldensity(PSD).Itisthedominantfrequencyc
omponentintheEEGsignal
forthatepochandshouldcharacterisetosomedegreetheund
erlyingsourcesignal.
f
peak
(
x
j
)=
i
peak
n
s
f
s
;
where
i
peak
=argmax
a
j
(
i
)
:
(3.14)
70
123456700.050.10.150.20.250.30.35Frequency (Hz)Occurrence  Reference EEGArtefactFigure3.14:ProbabilitydensityfunctionfortheSEF
80
ofbackgroundEEG(blue)and
head-movementartefact(green).

Spectraledgefrequency(80,90and95)

Spectraledgefrequency(SEF)isdenedasthefrequencyund
erwhichacertainpercentage
ofthepowerinthePSDlies.Inthiswork,threeSEFfeaturesa
reused,corresponding
to80%,90%and95%ofthepowerinthePSD.Accordingly,highe
rSEFsshouldbe
inuencedbyhead-movementartefactarisingfromEMGsourc
es.Thisisillustratedin
Figure3.14wherethepdfoftheartefactEEGislocatedsligh
tlytowardhigherfrequency
valuesthanthatofthenormalEEG.

Intensityweightedmeanfrequency(IWMF)

Theintensityweightedmeanfrequency
f
m
istheaveragefrequencyfromthefrequency
spectrum,anddenedas:
f
m
=
N
2

1
P
i
=0
p
i
idf
N
2

1
P
i
=0
p
i
;
(3.15)
where
i
isthefrequencybinnumber,
p
i
istheestimatedspectralpowerinthebinand
df
=
f
s
=N
,with
f
s
beingthesamplingfrequencyand
N
thetotalnumberoffrequency
bins.TheIWMFcorrespondstotheexpectedfrequencyvaluei
nanEEGepoch
x
j
.
71
012345678910x 10400.010.020.030.040.050.060.07Total Power Occurrence  Reference EEGArtefactFigure3.15:Probabilitydensityfunctionforthetotalpow
erinthe0to12Hzrangeof
backgroundEEG(blue)andhead-movementartefact(green).

Intensityweightedbandwidth(IWBW)

Theintensityweightedbandwidth
bw
isdenedas:
bw
=
v

u

u

u

u

u

u

u

t
N
2

1
P
i
=0
p
i
(
f
m

idf
)
2
N
2

1
P
i
=0
p
i
:
(3.16)
Totalpower

ThetotalpowerreferstothesumofpowerinallbinsofthePSD
between0and12Hz:
P
total
(
x
j
)=
12
n
s
=fs
X
i
=0
p
j
(
i
)
;
(3.17)
where
p
j
(
i
)isthepowerinbin
i
ofepoch
x
j
.Thisfeaturewastakenfromepilepsy
(D'Alessandroetal.,2003;SaabandGotman,2005;Fauletal
.,2009)andneonatalseizure
detection(Greeneetal.,2008;Temkoetal.,2009;Thomaset
al.,2010)papersandrefers
tothetotalpowerinthefrequencyoftypicallynormalEEG.A
sshowninFigure3.15the
powerinartefactEEGtendsbedistributedmoreuniformlyth
anthatofthebackground
EEGwhichhasapeakat0.75Hz.
72
Powerbandsandnormalisedpowerbands

PowersinspecicEEGsub-bandsarewidelyusedfeaturesfor
EEGanalysisinepilepsy
research(Shoebetal.,2004),BCI(Pfurtschelleretal.,19
97)andneonatalseizuredetec-
tion(Thomas,2011).Inthisstudy,powerinfrequencybands
of2Hzwidthareextracted
fromthePSDcalculation;i.e.powerin0-2Hz,1-3Hz,2-4Hz,
3-5Hz,4-6Hz,5-7Hz,6-8
Hz,7-9Hz,8-10Hz,9-11Hz,10-12Hz.Thepowerinadditional
frequencybandsarealso
utilisedasfeatures,owingtotheirusefulnessinotherpap
ersonmuscleartefactdetection;
thesebandsare3-15Hz,15-30Hz,59-61Hz,51-64Hz,20-30Hz
,25-64Hz.
Inadditiontothepowerineachsub-band,thenormalisedpow
ersinthesesub-bands
werealsousedasfeatures.Thenormalisedpowerinasub-ban
dreectstheproportion
ofoverallsignalpowerexistinginagivensub-band,andare
calculatedbydividingthe
powerinasub-bandbythetotalpowerinthesignalforthatep
och.
3.3.3Entropy-basedfeatures

Ininformationtheory,entropyisameasureoftheuncertain
tyinarandomvariable.Shan-
non(1949)introducedtheconceptofentropyinthecontexto
fdigitalcommunicationbut
ithassinceprovedaneectivetoolinthepredictionandcha
racterizationofothersig-
nals.Consequently,entropyasintroducedbyShannon(1949
)aswellasotherinformation
measuresareutilisedhereasfeaturestocharacteriseEEGo
fdieringtypes.
Shannonentropy

Shannonentropyisameasureininformationtheoryforestim
atingtheuncertaintyofan
outcome(Shannon,1949).Itistheaverageunpredictabilit
yinarandomvariable,which
isequivalenttoitsinformationcontent.TocalculateShan
nonentropy,thesignalmust
rstberepresentedasadiscretedistribution.Thisisperf
ormedherebyapproximating
theprobabilitymassfunctionbya16-binhistogram.TheSha
nnonentropyofthe
j
th
epochisthusdenedas:
H
Sh
(
x
j
)=

16
X
i
=1
p
i
(
x
j
)
logp
i
(
x
j
)
;
(3.18)
73
234567800.0050.010.0150.020.0250.030.0350.04Shannon EntropyOccurrence  Reference EEGArtefactFigure3.16:ProbabilitydensityfunctionfortheShannone
ntropyofbackgroundEEG
(blue)andhead-movementartefact(green).

where
p
i
(
x
j
)isthemagnitudeofeachbin.Iftheentropyof
x
j
iszero,theobserver
iscertainofthefuturevalueof
x
j
.Highervaluesofentropythenindicateincreased
uncertainty.InFigure3.16itcanbeseenthattheartefactE
EGexhibitshigherentropies
(i.e.moredisorder)thanthatofthenormalbackgroundEEG.

Spectralentropy

WheretheShannonentropyisusedtoquantifytheorderinthe
EEGsignal,spectral
entropyisameasureoftheorderinthefrequencyspectrumof
theEEG:
H
Spec
(
x
j
)=

1
logN
N
X
i
=1
z
i
logz
i
;
(3.19)
where
i
isafrequencyindexand
z
i
isanormalisedpowerspectraldensity
S(
!
i
):
z
i
=
S(
!
i
)
P
N

j
=1
S(
!
j
)
:
(3.20)
SVDentropy

SingularValueDecomposition(SVD)isameasureofthecompl
exityofasignal,often
usedtoobtaininformationaboutquasi-periodicsignalsin
noise.TheSVDalgorithm
decomposesamatrixsuchthat:
A
=
USV
T
(3.21)
74
where
A
istheinputmatrix,where
U
and
V
haveorthogonalcolumnssuchthat
U
T
U
=
I
and
V
T
V
=
I
,with
I
beingtheidentitymatrixand
S
isadiagonalvectorofsingular
values.Thesingularvaluesin
S
refertothemostsignicantunderlyingcomponentsin
thesignal.Thenumberofsingularvaluesvarieswiththecom
plexityofthesignal,withan
increaseinsignalcomplexityleadingtoalargernumberofs
ingularvalues.Thenumberof
signicantsingularvalues

1
:::
d
E
canbeobtainedusingRissanen'sMinimumDescription
Lengthalgorithm(Robertsetal.,1999).

TheSVDentropycalculatestheentropyinthesingularspect
rum(Robertsetal.,1999).
ByperformingSVDforanepochasdescribedinEquation3.21,
thesingularvalues

1
:::
d
E
canbefound.TheSVDentropyisthus:
H
SVD
=

d
E
X
i
=1
^

i
log
2
^

i
;
(3.22)
where
d
E
isthesingulardimensiongivenbyRissanen'sMinimumdescr
iptionlength,and
where
^

i
isthenormalisedsingularvaluessuchthat
^

i
=

i
P
j

j
:
(3.23)
SVDentropiesshouldbelowerforquasi-periodicsignalssu
chasEEGbaselineoscillations
duetomovement.

Fisherentropy

TheFisherinformationiscalculatedfromthesingularvalu
esoftheEEGtodescribethe
shapeofthesingularspectrum.
I
Fisher
(
x
j
)=
d
E

1
X
i
=1
(
^

i
+1

^

i
)
2
^

i
:
(3.24)
3.4Featurereductionandlineardiscriminantclassication

ThefeaturesoutlinedinSection3.3describevaryinglevel
sofseparationbetweenback-
groundandartefactEEGclasses.Astatisticalpatternreco
gnitionclassierthenattempts
tousethesefeaturestondsomeoptimalseparatinghyperpl
anesuchthatfeaturesex-
75
tractedfromnormalEEGlieononesideofthehyperplaneandf
eaturesextractedfrom
artefactEEGlieontheother.Lineardiscriminantclassie
rshaveaverylowcompu-
tationalrequirementandgenerallyprovidereasonableres
ults,makingthemsuitablefor
proof-of-conceptexperiments.Additionally,thelowcomp
utationalburdenmakesLDCs
idealforonlineclassication;inparticularLDCshavebee
nwidelyusedinBCIapplica-
tions(Allisonetal.,2007;Lotteetal.,2007).Therefore,
thepremisethatageneralised
head-movementartefactclasscanbeusedtodetectartefact
sintroducedintotheEEGby
head-movements,istestedwithlineardiscriminantclassi
cation.
Themajorityofpapersintheliteratureextractfeaturesfr
omonesecondwindowsofEEG.
However,thishasrarelybeensupportedwithcompellingevi
denceastowhythiswindow
lengthwaschosen.Ashead-movementartefactsoccurwithdi
eringlengths,itisnot
clearwhatwindowlengthbestcapturesthesignalcharacter
istics.Inordertoinvestigate
whatwindowlengthwouldbemostappropriateforclassifyin
ghead-movementartefact,
thisclassicationtaskwasperformedforwindowlengthsof
0.25,0.5,0.75,1,1.5,2,3,
and4seconds.

3.4.1Featurereductionusingmutualinformationevaluati
onfunction
Formostmachinelearningclassiers,alargefeaturesetma
ybedetrimentaltotheper-
formanceoftheclassier,inparticularwhenthenumberofd
atapointsislimited.This
\curseofdimensionality",whichimpliesthatcomplexityo
ftheclassicationtaskincreases
exponentiallywiththedimensionofthedata,meansthatinp
racticeitmaybebenecial
tolimitthenumberoffeaturestoonlythosewhicharemostdi
scriminativefortheclassi-
cationtask(Abu-Mostafaetal.,2012).Thereexistsawide
rangeofmethodsavailable
toreducethesizeofthefeatureset,broadlycategorisedas
ltertechniques,wrapper
methodsandembeddedtechniques(Saeysetal.,2007).Gener
allyspeaking,ltertech-
niquesareindependentoftheclassier,whereaswrapperan
dembeddedmethodsrequire
aclassiertobechosenbeforefeaturereductionisperform
ed.Filtertechniquesassessthe
relevanceoffeaturesbyexaminingintrinsicpropertiesof
thedata,usuallybycalculating
somefeaturerelevancescore(suchascorrelationormutual
information)thatcharacterises
theinformationbetweenthefeatureandtheclasslabels.Lo
w-scoringfeaturesarethen
removed,andtheremainingfeaturesarepresentedtothecho
senclassicationalgorithm.
Filtertechniquesarethoseindependentofthechosenclass
ier,andoerageneralpicture
astowhatfeaturesmightbeusefulfortheclassicationtas
k,irrespectiveofclassication
76
algorithm.Asthefeatureselectionwasperformedatthepro
of-of-conceptstagewherea
nalclassicationalgorithmisyettobechosen,altertec
hniquewasemployed.
Amulti-variateltertechnique,mutualinformationevalu
ationfunction(MIEF),wascho-
sen(Al-AniandDeriche,2002).MutualInformationisusedh
ereasameasureofusefulness
ofindividualfeaturesindistinguishingbetweennormalEE
Gandheadmovementartefact.
MIEFchoosesthefeaturewithhighestmutualinformationbe
tweenthefeatureandthe
classlabels.Additionalfeaturesweresubsequentlyranke
dbyinformationgainbasedon
howmuchadditionalinformationtheyprovidedtotheclassi
cationproblem.MIEFis
thereforemoreusefulthansimplyusingmutualinformation
alonetorankfeaturesasit
takesredundancybetweenfeaturesintoaccount,obtaining
thebestgroupperformanceof
features.Additionally,itisbetterthanusingsimplecorr
elationtorankfeatures,asthe
correlationtakesonlylinearconnectionsbetweenseriesi
ntoaccount,andclassication
algorithmsoftenexploitnon-linearsimilaritiesintheda
ta.TheideaofselectingEEG
featuresbasedonMutualInformation(MI)usingtheMutualI
nformationEvaluation
Function(MIEF)proposedbyDericheandAl-Ani(2001)haspr
eviouslybeendemon-
stratedforseizuredetectionsystemsbyFaul(2007).TheMI
I
(
X
;
Y
)betweenrandom
variables
X
and
Y
measurestheamountofinformationin
X
thatcanbepredictedwhen
Y
isknown.If
X
and
Y
arecontinuous,then:
I
(
X
;
Y
)=
H
(
X
)

H
(
X
j
Y
)=
Z
P
XY
(
x;y
)
log
P
XY
(
x;y
)
P
X
(
x
)
P
Y
(
y
)
dxdy;
(3.25)
where
H
(
X
)istheentropyof
X
and
H
(
X
j
Y
)istheconditionalentropyof
X
given
Y
.
Convertingtodiscretedata,bydividingthe
XY
planeintoboxesofsize
x

y
,givesMI
as:
I
(
X
;
Y
)=
X
r
x
X
r
y
P
XY
(
r
x
;r
y
)
log
P
XY
(
r
x
;r
y
)
P
X
(
r
x
)
P
Y
(
r
y
)
;
(3.26)
where
r
x
and
r
y
arethediscretelevelsof
X
and
Y
respectively.
TheMIEFalgorithmproposedbyAl-AniandDeriche(2002)sel
ectsfeaturesbasedon
theirMIwiththeoutput
I
(
C
;
f
i
),theirMIwiththepreviouslyselectedfeatures
I
(
f
i
;
f
j
)
andthejointMIofthetestfeatureandthepreviouslyselect
edfeatureswiththeoutput
I
(
C
;
f
f
i
;f
j
g
).TheMIEFalgorithmcanthusbedescribedasfollows:
1.Foreachfeature
f
i
2L
,choosethefeaturethathasthemaximal
I
(
C
;
f
i
).
(a)Set
K f
f
i
g
.
77
(b)Set
g
(
K
)
 
I
(
C
;
f
i
).
2.Foreachfeature
f
i
2L
;f
i
=
2K
,compute:
m
(
f
i
)=
g
(
K
)+
I
(
C
;
f
i
)
;
(3.27)
andchoosethefeaturethatmaximises
m
(
f
i
).
(a)Set
K K[f
f
i
g
.
(b)Set
g
(
K
)=
m
(
f
i
).
3.If
jKj
<
jLj
,gotostep2.
4.
g
(
L
)=
g
(
K
)
3.4.2MIEFresults

Afeaturesetofthe12best-performingfeatureswaschosenu
singMIEFforeachwindow
length.Asubsetof12featuresischosenasitcorrespondsto
thelevelling-oofinformation
gainformanyofthewindowlengthsinvestigated.Thatistos
ay,addingmorefeatures
didnotsubstantiallyincreasethemutualinformationbetw
eenthefeaturesetandthe
classlabels.12ofthebestperformingfeatures,forwindow
lengthofonesecondare
listedinTable3.3a,where
I
(
c;f
)istheMutualinformationbetweenthefeatureandthe
classlabels,andthechangein
m
(
f
)isameasureoftheinformationgainedbyadding
anadditionalfeature.Similarly,the12bestperformingfe
aturesforwindowlength=1.5
secondsaredisplayedinTable3.3b.

Themutualinformationcalculationsperformedaspartofth
eMIEFalgorithmillustrate
thatthefeaturesetappearstobeagoodtwiththetargetcla
sses.Additionally,several
featureswhichdidnotshowhighmutualinformationbetween
itandthetargetclass,
didcontaininformationthatotherfeaturesdidnothold,an
dthusaddedtotheclassier
performance.Thisisparticularlyprescientindealingwit
hageneralisedmovementartefact
class;asfeatureswhichexhibitgoodcorrelationwithcomp
onentsignalsmayperform
poorlyfortheheadmovementclassasawhole.Thefeaturemay
thereforecontribute
signicantinformationintermsofdescribingoneofthecom
ponentartefactsignals,while
testingpoorlyfordescribingtheheadmovement.Thisisill
ustratedinthedatabythe
powerinthefrequencybands59-61Hzand51-64Hz,whichhadp
oorcorrelationbetween
featureandthetargetclass(0.0024196,and0.001474forwi
ndowlength=0.75)butranked
78
high(18and20)intheMIEFalgorithmastherewassomeinform
ationgainassociated
withtheirinclusion.

Therewasnoobviouslybadfeature,thatconsistentlyranke
dlow,orindeedrankedlow
intermsofbothmutualinformationandinformationgain.

Therewasvariationinthefeaturesetchosenforeachwindow
length.Thisisunderstand-
ablegiventhefactthatthefeaturesmayeachcapturesignal
characteristicsthataremost
evidentoverdierentsignaltimelengths.Additionally,i
nmanycasestheremayhave
beenverylittledierenceintheinformationgainvalueass
ignedtoseveralfeaturesat
agiventime.Ifonefeaturewaschosenoveranother,theseco
ndfeaturewouldlikelybe
relegateddownthetableofchosenfeaturesinthenextpasso
ftheMIEFalgorithm.Thus,
ifMIEFisperformedforadierentwindowlength,wherethei
nformationgainresults
atagivensplitisslightlyaltered,theMIEFresultscoulda
ltersignicantly.However,
despitethatcaveat,thefollowingfeaturesperformedwell
formostwindowlengths:au-
toregressivet(severalmodels),SVDentropy,Shannonent
ropy,zerocrossingsandline
length.ThisishighlightedinTables3.3aand3.3b.Fromthi
s,itcanbededucedthat
thisfeaturesetisrobusttodierencesinwindowlength,an
dthatthesefeaturestendto
provideddierentsourcesofinformationfortheclassica
tiontask.Theresultsfromthe
MIEFalgorithmshowthatwhiletherewasadierencebetween
thefeatureschosen,the
mutualinformationbetweenindividualfeaturesandthetar
getwashigh(
>
0.05)formany
features.Thiscanbeexplainedinpartbythefactthatwhile
alotofthefeaturesperform
wellintermsofthemutualinformationbetweenitandthetar
getclass,manydidnot
necessarilyaddsignicantinformationgain.Thusifonefe
atureisrankedhighly,similar
featurestendtoberankedtowardthebottomoftheMIEFtable
.Notehowever,thatthis
isnotthecasefortheautoregressivemodelfeatures;ARmod
elsofdierentorderscan
producesignicantlydierentresults.

3.4.3Lineardiscriminantclassication

Alineardiscriminant(LD)isafunctionthattakesaninputv
ector
x
j
andassignsitto
oneof
k
classes,
w
c
=
w
1
;:::;w
k
;thefunctionordecisionsurface,
g
(
x
)isahyperplane.
Lineardiscriminantclassicationthenisastatisticalpa
tternrecognitionmethodthat
ndsalinearcombinationoffeaturesthatcharacterisesor
separatestwoormoreclasses
ofevents.AsdiscussedinSection2.5,thedecisionsurface
isfoundbytrainingthelinear
discriminantclassier(LDC)onlabelled(i.e.annotated)
data.Inthiswork,only2-
79
Table3.2:TopperformingEEGfeaturesfortheartefactdete
ctiontaskasrankedbyMIEF
forwindowlengthsof(a)1secondand(b)1.5seconds
Feature
I(c,f)m(f)
Linelength
0.17015-
ShannonEntropy
0.133720.26378
SVDEntropy
0.0675160.3313
Autoregressivet1
0.0905450.42184
Autoregressivet2
0.0706180.49246
Activity
0.06644110.55887
Autoregressivet4
0.063120.62199
Autoregressivet5
0.062390.68438
ZeroCrossings
0.0622220.7466
Autoregressivet7
0.0620650.80867
Autoregressivet9
0.061240.86991
Autoregressivet3
0.0599160.92983
(a)MIEFforwindowlength1second
Feature
I(c,f)m(f)
SVDEntropy
0.2489-
ShannonEntropy
0.05340.30192
Zerocrossingsofrstderivative
0.116080.41797
Autoregressivet1
0.13720.5079
Autoregressivet2
0.141330.57217
Autoregressivet3
0.138230.62502
SpectralEdgeFrequency95
0.0455490.67056
Autoregressivet5
0.141310.77475
Autoregressivet8
0.132170.84829
ZeroCrossings
0.0414880.88978
Linelength
0.0369750.92675
Autoregressivet4
0.145140.96465
(b)MIEFforwindowlength1.5seconds
classclassicationisconsidered,withclassescorrespon
dingtohead-movementartefact
andbackgroundEEG.Thefollowingparagraphsprovidesomet
heoreticalbackgroundof
lineardiscriminantclassicationderivedinaBayesianfr
amework,i.e.usingagenerative
approach.

LDCtheoreticalbackground

Bayesiandecisiontheoryisafundamentalstatisticalappr
oachtothelineardiscriminant
methodofpatternclassication.Thisapproachisbasedonq
uantifyingthetrade-os
betweenclassicationdecisionsusingprobabilityandthe
coststhataccompanysuchdeci-
sions.Bayesiandecisiontheorymakestheassumptionthatt
hedecisionproblemisposed
inprobabilisticterms,andthatalloftherelevantprobabi
lityvaluesareknown(Duda
etal.,1995).Assuch,decidingwhichclass
c
thatatestpoint
x
j
belongstoisbasedon
whichclasshasthehighestposteriorprobability
P
(
w
c
j
x
j
),thatis:
g
(
x
j
)=
P
(
w
c
j
x
j
)
;c
=1
;
2
:
(3.28)
Bayes'theoremstatesthattheposteriorprobabilityofafe
aturevector
x
j
belongingto
class
w
c
isrelatedtothepriorprobabilitiesofbothclassesandthe
conditionalprobability
ofthevector
x
j
giventheclasses:
P
(
w
c
j
x
j
)=
p
(
x
j
j
w
i
)
P
(
w
c
)
P
2

c
=1
p
(
x
j
j
w
c
)
P
(
w
c
)
:
(3.29)
80
Since
P
2

c
=1
p
(
x
j
j
w
c
)
P
(
w
c
)isthesameforbothclasses,thedenominatorcanbeomitted
.
Asthedecisionboundaryisnotunique,thedecisionisuncha
ngedbymultiplyingbya
constantorshiftedbyaconstant.Thatis,if
g
(
x
)isreplacedby
f
(
g
(
x
)),where
f
(
:
)is
amonotonicallyincreasingfunction,theresultisalsounc
hanged.Thus,thediscriminant
functionis:
g
(
x
)=
lnp
(
x
j
j
w
c
)+
lnP
(
w
c
)
:
(3.30)
Sincethelikelihood
p
(
x
j
j
w
c
)isassumedGaussianitcanberepresentedby:
p
(
x
j
j
w
c
)
˘N
(

c
j

c
)=
1
(2
ˇ
)
d=
2
j
P
c
j
1
=
2
e

1
2
(
x


c
)
T


1
c
(
x


c
)
;
(3.31)
where

c
and

c
arerespectively,thetwo-dimensionalmeanvectorand2-by-
2dimension
between-classcovariancematrix,givenby:

c
=
X
(
x
j


c
)(
x
j


c
)
T
;
(3.32)
and
j

c
j
isthedeterminantofthecovariancematrix.Thus:
g
(
x
j
)=
lnP
(
w
c
)+
ln

1
(2
ˇ
)
d=
2
j
P
c
j
1
=
2
e

1
2
(
x


c
)
T


1
c
(
x


c
)

(3.33)
=
lnP
(
w
c
)

1
2
ln
(2
ˇ
)

1
2
ln
(
j

c
j
)

1
2
(
x


c
)
T


1
c
(
x


c
)
:
(3.34)
Aslineardiscriminantclassiersassumethatthecovarian
cesareequal(

c
=

),and
discardingalltermsthatarenotdependenton
w
c
,then:
g
(
x
j
)=
lnP
(
w
c
)

1
2

T

c


1

c
+

T

c


1
x
j
(3.35)
=
w
T
x
j
+
w
0
:
(3.36)
Thediscriminantfunction
g
(
x
)isthusalinearcombinationofthecomponentsof
x
j
,where
x
j
istheweightvectorand
w
0
isthebiasorthresholdweight.
Atwo-categorylinearclassier(e.g.artefactvs.normalE
EG)implementsthefollowing
decisionrule:
g
(
x
)
8

<

:
>
0Decide
w
1
<
0Decide
w
2
(3.37)
Theequation
g
(
x
)=0denesthedecisionsurfacethatseparatespointsassig
nedto
81
w
1
fromthoseassignedto
w
2
.Thisseparatinghyperplaneisthenobtainedbyseeking
theprojectionthatmaximisesthedistancebetweenthemean
softhetwoclasses,while
minimisingtheinter-classvariance.

AstherearenoparameterstochangeintheLDclassier,thep
erformanceoftheLDCis
measuredbythesensitivityandspecicityvalues(Section
2.9.4).Anadditionalmetric,
accuracy
,isalsousedhere,toincorporatebothsensitivityandspec
icityinonevalue;the
accuracyisdenedasthemeanofthesensitivityandspecic
ityvalues.
LDCmodelselection

Inordertotestthepremisethatageneralisedhead-movemen
tartefactclasscouldbeused
todetectartefactsintroducedintotheEEGbyhead-movemen
ts,alineardiscriminant
classicationalgorithmwasused.LDclassiersweretrain
edandtestedonthehead-
movementartefactdatasetdescribedinSection2.9.1using
5-foldcross-validation(Kohavi,
1995).Thus,LDCsweretrainedusingfourfthsofthedatafr
omallparticipantsand
testedontheremainingfthofdatapoints.Thisprocesswas
thenrepeatedvetimes,
ensuringthattheclassicationresultswerenotoverlyopt
imisticorpessimisticduetoa
biasedtrain/testsplit.This5-foldcrossvalidationwasp
erformedforeachofthefollowing
windowlengths:0.25,0.5,0.75,1,1.5,2,3,4seconds.Fore
achwindowlength,the12
highest-rankingfeaturesfromtheMIEFalgorithmwerechos
en.Thistrainingandtesting
processwasrepeated20timesperwindowlength(toaccountf
orpotentialbiasesinthe
randomlyselecteddata),andtheresultingmeansensitivit
yandspecicityvalueswere
reported.

3.4.4LDCperformance

SpecicityandsensitivityresultsfromtheLDCareshownin
Figure3.17,indicatingthat
thefeaturesetisusefulinseparatingbetweennormalEEGan
dartefactsinducedbyhead
movement.Accuracyisthemeanvalueofsensitivityandspec
icityandisincludedhereas
asingle-gureindicationofclassicationperformance.C
lassicationperformancewasbest
forthosewindowlengthsinthemiddleoftheexaminedrange,
i.e.,forwindowlengthsof
0.5,0.75,1,and1.5seconds,whereclassieraccuracieswe
rehighest.Forwindowlengths
greaterandshorterthanthis,adropinclassicationperfo
rmancewasseen.Inparticular,
sensitivitywashighestforwindowlengthsof1.5seconds,a
ndspecicitywashighestfor
82
0.250.50.7511.523455606570758085Window lengths  SensitivitySpecificityAccuracyFigure3.17:Sensitivity,specicityandaccuracyfor12-f
eature,participantdependentLD
classiers.Resultsaredisplayedforwindowlengthsof0.2
5,0.5,0.75,1,1.5,2,3and4
seconds.

windowlengthsof1second.Thismaybeduetolongerwindowle
ngths,containingboth
normalandartefactdataandshorterwindowlengthsresulti
nginepochswhicharetoo
shorttoaccuratelyreectthecharacteristicsofthesigna
l.
ResultsfromthemutualinformationcalculationsandLDCcl
assierindicatethatthe
investigatedfeaturesetprovidesagoodseparationbetwee
nartefactandbackgroundEEG
classesforparticipant-dependentdata.Thisconrmsthev
alidityofusingageneralised
headmovementartefactclasswhendetectingnon-cerebrala
ctivityintheEEGinduced
byheadmovements.Thisndingisbuiltuponinthenextsecti
on,wheremorepowerful
classicationtechniquesareusedtoperformparticipant-
independentclassicationofhead-
movementartefacts.

3.5Supportvectormachines

LineardiscriminantclassiersperformbestforGaussiand
istributions.However,asisclear
fromtheprobabilitydensityfunctionsdisplayedinSectio
n3.3,thisisrarelythecaseforthe
featuresusedintheartefactdetectiontask.Thisprovides
astrongargumentforuseofa
non-linearclassierindistinguishingbetweennormalEEG
andthatcontaminatedbyhead
movements.Supportvectormachines(SVM)isonesuchfamily
ofclassiersthattend
toproduceexcellentclassicationperformancefortwo-cl
assproblems;Gaussiankernel
SVMclassiershaveprovenhighly-eectiveinanumberofot
hereventdetectionsystems
inEEG(Temkoetal.,2011b;Kelleheretal.,2010).SVMsbene
tfromtheadditional
83
advantageofbeingsomewhatindierentto\curseofdimensi
onality",thusallowingfull
advantagetobetakenofthecompletesetofEEGfeatures,rat
herthanperformingexplicit
featurereductionbeforetheclassication(Cristianinia
ndShawe-Taylor,2000).
3.5.1SVMtheoreticalbackground

Thefundamentalconceptofthesupportvectormachineistot
ransformasetoffeature
vectors
x
j
2
R
d
intoahigherdimensionalspaceandtondtheoptimalhyperp
lanein
thespacethatcanmaximizethemarginbetweenclasses.Bytr
ansformingthedatainto
ahigherdimensionalspace,complexclassicationproblem
scanbeconvertedintomore
simpleproblemsthatcanuselineardiscriminantfunctions
.AstheSVMisbasedonlyon
thosetrainingpatternsthatarenearthedecisionsurface,
classicationcalculationtimes
arequitesmall,allowingforeaseofimplementationinarea
l-timesystem.Furthermore,
assupportvectorsareasubsetofthetrainingdataandconta
inalltheinformationneeded
todenetheclassier,SVMsarehighlyinsensitivetothedi
mensionalityofthefeature
space.ThismakestheSVMidealforasystemwithalargenumbe
roffeaturesextracted
fromtheEEGsignal.Thefollowingparagraphsprovideabrie
fdescriptionofsupport
vectormachines,inthecontextoftwo-classsupervisedlea
rning.
Letatrainingfeaturevector
x
j
2
R
N
withassociatedlabels
y
j
2f
1
;

1
g
belongtolinearly
separableclasses,wherethedecisionsurfaceusedtoclass
ifyapatternisthehyperplane
H
0
.Theproblemofclassifyingatestvector
x
k
asbelongingtooneoftwoclassescanbe
writtenas:
f
(
x
k
)=
w

x
k
+
b;
(3.38)
where
w
2
R
N
.
H
0
istheregionofvectors
x
whichverifytheequation
f
(
x
)=0.If
H
1
and
H

1
aretwohyperplanesparallelto
H
0
,denedby
f
(
x
)=1and
f
(
x
)=

1,respectively,
thenthedistanceseparatingthesetwohyperplanesis:
d
=
2
jj
w
jj
:
(3.39)
Thedistance
d
,denotedthe
margin
,ismaximisedsoastoobtainaclassierboundary
thatisnotoverttothetrainingdata
x
j
.Tobecorrectlyclassied,thetrainingvectors
84
shouldlieoutsidethemarginoronthemarginboundaryandmu
stsatisfy:
w

x
j
+
b
+1
;
for
y
j
=+1
;
(3.40)
w

x
j
+
b
1
;
for
y
j
=

1
:
(3.41)
Thiscanbewrittenmoreconciselyas:
y
j
(
w

x
j
+
b)

1
8
j:
(3.42)
TheproblemofndingtheSVMclassifyingfunction
H
0
canbestatedas:
minimise
1
2
jj
w
jj
2
;
subjectto
y
j
(
w

x
j
+
b)

1
8
j:
(3.43)
Asreal-worldbiomedicaldataareoftennotlinearlysepara
ble,withconsiderableoverlap
betweenclasses,thedecisionboundarycanbe
softened
byintroducinga
slack
positive
variable
˘
j
foreachtrainingvector.Theconditionsthatthetrainingv
ectorsmustsatisfy,
denedinEquations3.40and3.41cannowbemodiedtoinclud
e
˘
j
suchthat:
w

x
j
+
b
+1

˘
j
;
for
y
j
=+1
;
(3.44)
w

x
j
+
b
1+
˘
j
;
for
y
j
=

1
:
(3.45)
Theintroductionof
˘
j
isproblematicinthattheconstraintsin3.44and3.45willb
emet
forall
j
if
˘
j
issuitablylarge.Toavoidtrivialsolutions,aregularisa
tionconstant
C
is
introducedintotheobjectivefunctionwhichnowbecomes:
minimise
1
2
jj
w
jj
2
+
C
N
X
j
=1
˘
j
;
subjectto
y
j
(
w

x
j
+
b)

1
8
j:
(3.46)
Theregularisationparameter
C
thuscontrolsthedegreeofpenalisationintroducedby
˘
j
,suchthatincreasing
C
permitsfewertrainingerrorsattheexpenseofreducedgen-
eralisation.TheconvexoptimisationproblemoutlinedbyE
quation3.46issolvedwith
Lagrangianmultipliers

j
.Onlytrainingpatternslyingonthemarginsurfaceorwithi
n
themarginhavenon-zero

j
;thesearethesupportvectors.Theclassicationprocess
thusconsistsofassigningoneofthetwoclassestoagivenin
putvector
x
k
ofdimension
N
,suchthat:
f
(
x
k
)=
M
X
k
=1

k
y
k
x
k

x
j
+
b;
(3.47)
where
M
isthenumberofsupportvectorsand
M<N
.
85
Inthecaseofclassicationproblemsthatarenon-linearly
separable,thedataismapped
toahigherdimensionalfeaturespacewherethedataareline
arlyseparable,suchthatthe
classicationfunctionbecomes:
f
(
x
k
)=
M
X
k
=1

k
y
k
˚
(
x
k
)

˚
(
x
j
)+
b;
(3.48)
wherethedotproduct
˚
(
x
k
)

˚
(
x
j
)canbereplacedbyakernelfunction
K
,suchthat:
K
(
x
j
;
x
k
)=
˚
(
x
k
)

˚
(
x
j
)
:
(3.49)
Inthisthesis,aGaussianradialbasisfunction(RBF)kerne
lisused,denedby:
K
(
x
j
;
x
k
)=
e

1
2
˙
2
j
x
k

x
j
j
2
:
(3.50)
Inpractice,itisnotnecessarytoknowthemappingfunction
˚
explicitly,thankstoa
mathematicalpropertyknownasthe
kerneltrick
(Scholkopf,2001).Inthiscontext,only
thekernel
K
(
x
j
;
x
k
)mustbeknown,andcanbeinterpretedasanon-linearsimila
rity
measurebetweenthetwodatapoints.TheSVMclassieristhu
s:
y
(
x
k
)=
sgn

M
X
l
=1

l
y
l
K
(
x
k
;
x
l
)+
b
;
(3.51)
where
M
isthenumberofsupportvectors.
TheoutputscoresoftheSVMcanbeconvertedtoaprobabilist
icestimationofclassby
meansofasigmoidfunction:
P
(
Art
j
x
)
ˇ
P
A;B
(
f
)=
1
1+
exp
(
Af
+
B
)
;
(3.52)
where
P
(
Art
j
x
)istheprobabilitythatanepochcontainsartefactactivit
y,
f
=
f
(
x
)isthe
distancetotheseparatinghyperplane(i.e.theoutputofth
eSVMclassier),and
A
and
B
aretheparametersofthesigmoidfunctionestimatedonthet
rainingdataset(Platt,
1999).Thisprobabilityoutput
P
(
Art
j
x
)iscomparedtoathresholdvalue

,resultingina
binarydecision;1indicatingartefactactivityand0indic
atingnormal,backgroundEEG.
Thus,byspecifyingthethreshold

,theclassiercanbemadetooperateinachosen
regionoftheROCcurve(Section2.9.4).
86
3.5.2SVMmodelselection

Thehead-movementartefactclassicationtaskwasimpleme
ntedwithGaussianRBF-
kernelSVMsandrepeatedforeachofthewindowlengthsinves
tigatedwithLDCs.An
outlineoftheentireSVMclassicationarchitectureisdis
playedinFigure3.18.Inthe
classicationtaskoutlinedhere,SVMsweretrainedandtes
tedonparticipantindependent
datasets;i.e.theSVMclassierusedtodetectartefactsin
aparticipant'sEEGrecording
wasnottrainedonanydatafromthatparticipant.

Leave-one-outcross-validation(LOO-CV)isusedtoevalua
tetheparticipantindependent
SVMclassierperformance.Inthismanner,allbutoneofthe
participants'dataisused
fortrainingandtheremainingparticipants'dataisusedfo
rtesting.Thisprocedureis
repeateduntileachparticipanthasbeenatestsubjectandt
hemeanresultisreported.
Theleave-one-outmethodisknowntobeanalmostunbiasedes
timationofthetrue
generalizationerror;i.e.,theperformancereportedwith
theleave-one-outmethodisthe
mostsimilartotheperformancethissystemwouldshowonanu
nseentestdatasetof
innitelengthonceitistrainedonallavailabledata(Vapn
ik,2006).Asdeployingsuch
anEEGsystemoutsideofacademiawouldlikelymeanperformi
ngartefactdetectionon
anunseenparticipant,theprocessoftrainingtheSVMsondi
erentparticipantsthan
thoseonwhichitwillbetested(andrepeatingforeachparti
cipant),theperformancethat
wouldlikelybeencounteredinareal-worlddeploymentisap
proximated.trainedinthis
thesisbestaccountforvariationsbetweenparticipants,T
heSVMsimplementedinthis
workarebasedontheLIBSVMlibrary(ChangandLin,2011).

Inpractice,theregularisationparameter
C
andthekernelvarianceterm
˙
2
mustbe
speciedforanRBF-kernelSVM.Inthisthesis,theseparame
tersarechosenbyperforming
5-foldcrossvalidationonthetrainingdata(Kohavi,1995)
;thedataisrandomlysplitinto
veequalparts,four-fthsofthedataisusedfortrainingt
hemodel,andtheremaining
fthisusedtoevaluatetheperformance.Thisprocessisrep
eatedvetimesandthebest
parametersetischosen.

3.5.3SVMperformance

ROCareasfortheparticipantindependentSVMsaredisplaye
dinFigure3.19.Boxplots
summarisetheROCareasacrossparticipantsherefortheeig
htwindowlengthsinvesti-
gated.Boxplotsdisplaydierencesbetweenpopulationswi
thoutmakinganyassumptions
87








˘ˇ
˛˚
˜ˇ
 !" !"

Figure3.18:Head-movementartefactdetectionsystembase
donsupportvectormachines
classier.ClassicationisperformedoneachEEGchannels
eparately.
abouttheunderlyingstatisticaldistribution,i.e.theya
renon-parametric.Thespacings
betweenthedierentpartsoftheboxindicatethedegreeofs
preadandskewnessinthe
data,andidentifyoutliers.Boxplotssummarisethedatawi
thvenumbers:thesmall-
estobservation(sampleminimum),largestobservation(sa
mplemaximum),lowerquartile
(Q1),median(Q2),upperquartile(Q3).Sampleminimaandma
ximaareindicatedbythe
horizontalblacklinesattheendofthewhiskers.Lowerandu
pperquartilesareindicated
bythehorizontalbluesidesoftheboxes.Samplemedianisin
dicatedbythehorizontal
redlines.

Classicationresultsforthegeneralisedhead-movementa
rtefactvalidatedthefeasibility
ofusingofageneralisedhead-movementclassindetectinga
rtefactsusingparticipant
independentdatasets.ROCareawashighestforawindowleng
thof0.75secondsat
83%;averageROCareawas80.2%acrosswindowlengths(
˙
=2
:
7%).However,the
dierencesbetweenROCareasacrosswindowlengthswassmal
lwhenconsideringthe
variationinROCareasbetweenparticipants.

3.6Summary

Inthischapter,artefactdetectionforambulatoryEEGwasi
ntroduced.Astatisticalma-
chinelearningapproachwastakentotheproblemofidentify
ingEEGsectionsthatare
contaminatedbyelectricalactivityarisingfromnon-cere
bralsources.Thus,acompre-
hensivefeatureset(comprisingtimedomain,frequencydom
ainandinformationtheoretic
88
0.250.50.7511.52340.550.60.650.70.750.80.850.90.95ROC area Window length (seconds)Figure3.19:ROCareasofparticipantindependentSVMclass
iersforarangeofwindow
lengths.

features)wascompiledandinvestigatedforitsabilitytop
rovideseparationbetweennor-
malEEGandEEGthathasbeencontaminatedbyartefactfollow
inghead-movement.
Inspectionofthefeatures'probabilitydensityfunctions
andmutualinformationwiththe
classlabelsindicatedtheirusefulnessinthegeneralised
head-movementartefactdetection
task.Thisconceptofgeneralisedhead-movementartefactd
etectionwasthenvalidated
usingareducedfeaturesetandalineardiscriminantclassi
er;classicationaccuraciesof
between65%and70%wererecordedforeachofthewindowlengt
hsinvestigatedwith
awindowlengthof1.5secondsshowingthebestperformance.
Withthefeasibilityof
detectinghead-movementartefactswithasingleclassier
conrmed,classicationusing
asupportvectormachinesclassierwasperformedutilisin
gthefullfeatureset.Mean
ROCareasofbetween75%and83%wereobserved,thistimeonth
emorediculttask
ofparticipantindependentartefactdetection.Awindowle
ngthof0.75secondsresulted
inthehighestmeanROCareaof83%;however,giventhevariat
ioninclassication
performanceacrossparticipants,adenitivelybestwindo
wlengthwasnotchosen.The
SVMclassiertrainedandtestedinthischapteristhussuit
ableforartefactannotationof
EEGrecordedinanambulatoryenvironment,andtotheauthor
'sknowledgeistherst
ofitskind.Additionally,thisartefactdetectorcouldbei
ncorporatedintoanautomated
neurologicaleventdetectionsystemateitherthepre-proc
essing(viaartefactrejection)or
post-processingstage(viaclassierfusion).
89
Chapter4

Detectinghead-movement

artefactswithgyroscopes

4.1Introduction

ItwasshowninChapter3thatasheadmovementsoftenresulti
nEEGartefacts(andcer-
tainhead-movementsmaybemorelikelythanotherstoresult
inartefact),itfollowsthat
informationregardingmovementsoftheheadcouldleadtoin
sightsintothesubsequent
productionofartefactintheEEG.Gyroscopes,devicesthat
measureangularrotation,
oerameansofaccuratelydetectingheadmovements.Recent
advancesintheminiaturi-
sationofgyroscopeshaveresultedintheirinclusioninthe
commerciallyavailableEmotiv
EPOCEEGheadset(EmotivEPOCheadset).Thischapterinvest
igatestheuseofthe
gyroscopesbuiltintotheEmotivEPOCheadsetinprovidingi
nformationonheadmove-
mentandsubsequentlyusingthisinformationtodetectresu
ltantcontaminationofthe
EEGsignals.Ajournalpaper(O'Reganetal.,2013a)andanin
ternationalpeer-reviewed
conferencepaper(O'Reganetal.,2010b)havearisenfromth
eworkcarriedoutinthis
chapter.

4.2Gyroscopes

Theadventofminiaturizedsensingtechnologyhaspavedthe
wayforinconspicuousbody-
wornsensorsthatallowthecollectionandstorageofdatame
asuringthedierentaspects
90
ofhumanmovement.Accordingly,avastbodyofliteratureha
sgrowninconjunctionwith
this,outliningwaysinwhichadvancedsignalprocessingan
dstatisticalpatternrecognition
techniquescanbeappliedtosignalsgeneratedbyinertials
ensorssuchasgyroscopesand
accelerometersinordertoprovideinformationonvariousf
ormsofbodymovementsand
physicalactivities.Gyroscopeshavebeeneectivelydepl
oyedtocapturemotionforawide
rangeofbiomedicalapplications,e.g.BourkeandLyons(20
08)usedbi-axialgyroscopes
forfall-detection.Severalpapershaveoutlinedtheuseof
gyroscopesinconjunctionwith
accelerometersforfalldetectionintheelderly(Greeneet
al.,2010),gaitanalysisduring
walkingandrunning(McGrathetal.,2012)andgaitassessme
ntofpatientswithParkin-
son'sdisease(Salarianetal.,2004).

TheEmotivEPOCheadsetisequippedwithtwomicroelectrome
chanicalsystems(MEMS)
gyroscopeslocatedontheprintedcircuitboardatthebacko
fthedevice.Thesegyro-
scopeswereinitiallyincludedintheEPOCforattitudinalc
ontrolinBCIapplications.
However,thisset-upoersaninexpensivemethodofutilisi
nginertialsensorstogainin-
sightintohead-movementsandconsequentlyintothehead-m
ovementartefactdetection
task.Internally,theMEMSgyroscopesuselithographicall
yconstructedvibratingwheels.
Whenmovementoccurs,awheelisdriventorotateafractiono
fafullturnaboutits
axis.Thetiltofthewheelisthenmeasuredtoproduceasigna
lrelatedtotherateof
rotation(Bernstein,2003).ThegyroscopesintheEmotivEP
OCprovidemeasurements
ofangularvelocitywithintwoplanes.Inthiswork,movemen
twithinthesetwoplanes
arereferredtoas
x
-directionand
y
-directionmovement;
x
-directionmovementrefersto
lateralrotationaroundtheneckaxisand
y
-directionmovementindicatesverticalrotation
aroundtheaxisjoiningtheears.Theseaxesareillustrated
inFigure4.1.
VisualinspectionoftheEEGandgyroscopesignalsoutlined
inFigure4.2showsclear
correlationbetweeneachofthetwogyroscopesignalsandth
eEEGtraceattimesofhead-
movements.However,as
x
-directionand
y
-directiongyroscopesignalseachdetectmove-
mentaboutoneaxisonly,eachsignalisappropriateforthed
etectionofcertaintypesof
movements.Thus,the
y
-directiongyroscopesignaladequatelyhighlightsperiod
sofEEG
artefactscausedbynoddingthehead,butisconsiderablyle
sssuccessfulindetectingthe
EEGartefactsbroughtaboutbyshakingthehead.Conversely
,the
x
-directiongyroscope
signalbarelyregistersthenoddingofthehead,butcompreh
ensivelyagsshakingofthe
headinamannerthatisclearlycorrelatedtosectionsofhea
d-movementartefact.To
combineinformationfrombothgyroscopesintoasingle,com
positegyroscopesignal,ab-
soluteangularvelocity

(
n
)iscreatedbytakingthesquare-rootofthesumofthesquare
d
91



Figure4.1:EmotivEPOCheadset:Gyroscopeaxes.
x
-and
y
-directiongyroscopesignals:

(
n
)=
q
gyro
x
(
n
)
2
+
gyro
y
(
n
)
2
:
(4.1)
Thisvaluequantiestheangularvelocitythattakesplacei
neitherdirection,givinga
measureofoverallhead-movementandindicatingwhetheror
nothead-movementhas
occurred.Astheremaybeanunknowndelaybetweenthehead-m
ovementasdetectedby
thegyroscope,andtheappearanceoftheresultantartefact
ontheEEGtrace,twodierent
movingaverage(MA)ltersareappliedto

(
n
)toproducetwoadditionalderivative
gyroscopesignals.ThelengthoftheMAlterswasdetermine
dbasedonobservation.A
10-pointMAlterwasappliedtotheabsoluteangularveloci
tysignal

(
n
)asdescribed
inEquation4.2.
MA
10
=
1
10
9
X
k
=0

(
n

k
)
:
(4.2)
Similarly,inEquation4.3a50-pointMAlterwasappliedto

(
n
):
MA
50
=
1
50
49
X
k
=0

(
n

k
)
:
(4.3)
AnexampleofthevegyroscopesignalsaredisplayedinFigu
re4.3,forthirtyseconds
ofdata,showingnoddingandshakingoftheheadinadditiont
osectionsofbackground
EEGactivitywherenohead-movementispresent.Similarly,
Figures4.4and4.5show
EEGandgyroscopesignalsforartefactsarisingfromraisin
gandloweringoftheeyebrows
92
00.20.40.60.811.21.41.61.82x 1043000400000.20.40.60.811.21.41.61.82x 10410003000Samples(fs=128Hz)
00.20.40.60.811.21.41.61.82x 10410003000Gyroscope

y-direction
Gyroscope

x-direction
EEG
NodHead
ShakeHead
Figure4.2:EEGchannelF8(blue)andgyroscopex-direction
(black)andy-direction(red)
signalsforartefactscausedbyraisingnoddingandshaking
head.
andfromclenchingthejaw,respectively.





















ˇˆ
ˆ
!˘
˝!˘
˛˛˚˝$"
)*˘+˙+

&*˘+˙+
,˝,˙
*˝/,˝˙˝!''˝˝,˙
*˝/,˝˙˝!''˝˝,˙
Figure4.3:EEGchannelFC5andall5gyroscopechannelsfora
rtefactscausedbynodding
andshakingofthehead,inadditiontosectionsofbackgroun
dEEGactivity.
93
